(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4033950c"],{"0b10":function(t,e,i){},"11e9":function(t,e,i){var s=i("52a7"),n=i("4630"),o=i("6821"),a=i("6a99"),r=i("69a8"),c=i("c69a"),l=Object.getOwnPropertyDescriptor;e.f=i("9e1e")?l:function(t,e){if(t=o(t),e=a(e,!0),c)try{return l(t,e)}catch(i){}if(r(t,e))return n(!s.f.call(t,e),t[e])}},1826:function(t,e,i){"use strict";var s=i("fa4e"),n=i.n(s);n.a},"1c01":function(t,e,i){var s=i("5ca1");s(s.S+s.F*!i("9e1e"),"Object",{defineProperty:i("86cc").f})},"24fd":function(t,e,i){"use strict";var s=i("4e10"),n=i.n(s);n.a},"297c":function(t,e,i){"use strict";var s=i("0b10"),n=i.n(s);n.a},"29e5":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-im-workbench"},[i("div",{staticClass:"mini-im-session-list"},[i("div",{staticClass:"title"},[i("el-row",{attrs:{type:"flex",justify:"space-between",gutter:20}},[i("el-col",{attrs:{span:16}},[i("span",[i("i",{staticClass:"el-icon-s-custom"}),t._v("\n                 ä¼šè¯åˆ—è¡¨ ( "+t._s(t.contacts.length)+"äºº )\n               ")]),i("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer"},attrs:{title:"æ¸…ç©ºåˆ—è¡¨"},on:{click:t.clearContact}})]),i("el-col",{attrs:{span:9}},[i("el-popover",{attrs:{placement:"bottom",width:"100"}},[i("div",{staticClass:"mini-im-online-setting"},[1!=t.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return t.online(1)}}},[i("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"rgb(135, 208, 104)"}}),t._v("\n                       æˆ‘è¦ä¸Šçº¿\n                     ")]):t._e(),0!=t.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return t.online(0)}}},[i("i",{staticClass:"el-icon-switch-button",staticStyle:{color:"#ccc"}}),t._v("\n                       æˆ‘è¦ä¸‹çº¿\n                     ")]):t._e(),2!=t.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return t.online(2)}}},[i("i",{staticClass:"el-icon-remove-outline",staticStyle:{color:"#e6a23c"}}),t._v("\n                       ç¹å¿™çŠ¶æ€\n                     ")]):t._e()]),0==t.adminInfo.online?i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("i",{staticClass:"el-icon-switch-button"}),i("em",[t._v("ç¦» çº¿ ")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})]):1==t.adminInfo.online?i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",{staticStyle:{color:"rgb(135, 208, 104)"}},[i("i",{staticClass:"el-icon-circle-check"}),i("em",[t._v("åœ¨ çº¿")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])]):i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",{staticStyle:{color:"#e6a23c"}},[i("i",{staticClass:"el-icon-circle-check"}),i("em",[t._v("ç¹ å¿™")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])])],1)],1)],1)],1),i("div",{staticClass:"mini-im-session-content"},[i("div",{staticClass:"mini-im-flex"},[t.contacts.length<=0?i("div",{staticClass:"mini-im-no-data"},[t._v("æš‚æ— ä¼šè¯æ•°æ®")]):t._e(),t._l(t.contacts,(function(e,s){return i("ContactComponent",{key:s,class:{"mini-im-chat-item-active":t.seviceCurrentUser.from_account==e.from_account},attrs:{deleteContact:t.deleteContact,clickItem:t.selectUser,item:e}})}))],2)])]),t.$store.getters.seviceCurrentUser.id?i("div",{staticClass:"mini-im-chat-view"},[i("div",{staticClass:"mini-im-chat-view-content-header"},[i("div",{staticClass:"mini-im-header-user-box"},[i("el-avatar",{staticClass:"mini-im-avatar",attrs:{size:35}},[""!=t.seviceCurrentUser.avatar?i("img",{attrs:{src:t.seviceCurrentUser.avatar}}):[t._v("è®¿")]],2),i("div",{staticClass:"mini-im-header-user-info"},[i("div",[t._v("\n                 "+t._s(t.seviceCurrentUser.nickname)+"\n                 "),1==t.seviceCurrentUser.online?i("span",{staticStyle:{color:"rgb(135, 208, 104)"}},[t._v("â— åœ¨çº¿")]):i("span",[t._v("â— ç¦»çº¿")]),t.isInputPongIng?[i("span",{staticClass:"input-pong"},[t._v(t._s(t.inputPongIngString)+" "),i("i",{staticClass:"el-icon-edit"})])]:t._e()],2),i("span",[t._v("ç”¨æˆ·æ¥è‡³ï¼š"+t._s(t.$getPlatformItem(t.seviceCurrentUser.platform).title)+"å®¢æˆ·ç«¯ï¼Œæ‰€åœ¨åœ°ï¼š"+t._s(t.seviceCurrentUser.address||"æœªçŸ¥"))])])],1),i("el-row",{staticClass:"mini-im-buttons"},[i("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[i("div",{staticClass:"mini-im-customer-list"},[i("div",{staticClass:"mini-im-customer-title"},[t._v("è¯·é€‰æ‹©è½¬æ¥çš„å®¢æœ ("+t._s(t.filterAdmins.length)+"äººåœ¨çº¿)")]),t._l(t.filterAdmins,(function(e){return i("div",{key:e.id,staticClass:"mini-im-customer-item",on:{click:function(){return t.transferCustomer(e)}}},[i("el-avatar",{staticClass:"mini-im-avatar",attrs:{size:30}},[i("img",{attrs:{src:e.avatar}})]),i("span",[t._v(t._s(e.nickname||e.username))])],1)})),0==t.filterAdmins.length?i("div",{staticClass:"mini-im-customer-item",staticStyle:{background:"none",border:"0"}},[i("span",[t._v("å½“å‰æ²¡æœ‰å…¶ä»–å®¢æœåœ¨çº¿")])]):t._e()],2),i("el-button",{directives:[{name:"show",rawName:"v-show",value:0==t.seviceCurrentUser.is_session_end&&0!=t.adminInfo.online,expression:"seviceCurrentUser.is_session_end == 0 && adminInfo.online != 0"}],attrs:{slot:"reference",icon:"el-icon-refresh",size:"small"},on:{click:t.getAdmins},slot:"reference"},[t._v("\n               è½¬æ¥å®¢æœ\n             ")])],1),0==t.seviceCurrentUser.is_session_end&&0!=t.adminInfo.online?i("el-button",{attrs:{icon:"el-icon-close",size:"small"},on:{click:t.closeSession}},[t._v("ç»“æŸä¼šè¯")]):t._e()],1)],1),i("div",{ref:"miniImChatViewBontentBody",staticClass:"mini-im-chat-view-content-body"},[i("div",{staticClass:"mini-im-chat-view-content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.advanceText.trim(),expression:"advanceText.trim() != ''"}],staticClass:"advance"},[i("div",[t._v("æ­£åœ¨è¾“å…¥ï¼š")]),i("span",[t._v("\n                 "+t._s(t.advanceText)+"\n                 "),t.isInputPongIng?[i("span",{staticClass:"input-pong"},[t._v(t._s(t.inputPongIngString.replace("å¯¹æ–¹æ­£åœ¨è¾“å…¥",""))+" "),i("i",{staticClass:"el-icon-edit"})])]:t._e()],2)]),i("div",{ref:"chatBody",staticClass:"mini-im-chat-body",attrs:{id:"chatBody"}},[i("ChatWindowComponent",{attrs:{onLoadMor:t.onLoadMorMessage,isMessageEnd:t.isMessageEnd,onCancelMessage:t.onCancelMessage,messages:t.messageRecord.list,loading:t.getMessageRecordLoading}})],1),i("div",{staticClass:"mini-im-chat-input"},[i("div",{staticClass:"mini-im-chat-input-bar"},[i("el-row",[i("EmojiComponent",{attrs:{clickEmoji:t.clickEmoji}}),i("span",{staticClass:"mini-im-button",attrs:{title:"é€‰æ‹©å›¾ç‰‡"}},[t._v("\n                       ğŸŒ\n                       "),i("input",{attrs:{onClick:"this.value = null",type:"file",accept:"image/*"},on:{change:t.sendPhotoMessageEvent}})])],1),i("el-row",[i("el-popover",{attrs:{placement:"top-start",width:"350",trigger:"hover"}},[i("div",{staticClass:"mini-im-shortcut"},[i("div",{staticClass:"mini-im-shortcut-head"},[i("span",[i("i",{staticClass:"el-icon-tickets"}),t._v("å¿«æ·è¯­å›å¤åˆ—è¡¨")]),i("div",[i("button",{attrs:{title:"æ·»åŠ "},on:{click:function(e){t.createShortcutDialogFormVisible=!0}}},[i("i",{staticClass:"el-icon-plus"})]),i("button",{attrs:{title:"ç¼–è¾‘"},on:{click:function(e){t.shortcutEditVisible=!t.shortcutEditVisible}}},[i("i",{staticClass:"el-icon-edit"})])])]),i("div",{staticClass:"mini-im-shortcut-body"},[i("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{clearable:"",type:"text",placeholder:"è¯·è¾“å…¥å…³é”®è¯",autocomplete:"off"},model:{value:t.shortcutKey,callback:function(e){t.shortcutKey=e},expression:"shortcutKey"}}),0==t.filterShortcuts.length?i("div",{staticClass:"mini-im-shortcut-item",staticStyle:{background:"none"}},[i("span",{staticStyle:{"text-align":"center","margin-top":"20px"}},[t._v("æš‚æ— å¿«æ·è¯­")])]):t._e(),t._l(t.filterShortcuts,(function(e){return i("div",{key:e.id,staticClass:"mini-im-shortcut-item",attrs:{title:e.content}},[i("span",{domProps:{innerHTML:t._s(e.title.replace(/\n/g,"<br>"))},on:{"!click":function(i){return function(){return t.checkShortcut(e.content)}()}}}),i("button",{directives:[{name:"show",rawName:"v-show",value:t.shortcutEditVisible,expression:"shortcutEditVisible"}],attrs:{title:"ä¿®æ”¹"},on:{"!click":function(i){return function(){return t.editShortcut(e)}()}}},[i("i",{staticClass:"el-icon-edit"})]),i("button",{directives:[{name:"show",rawName:"v-show",value:t.shortcutEditVisible,expression:"shortcutEditVisible"}],attrs:{title:"åˆ é™¤"},on:{"!click":function(i){return function(){return t.deleteShortcut(e)}()}}},[i("i",{staticClass:"el-icon-delete"})])])}))],2)]),i("button",{staticClass:"mini-im-button",attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"el-icon-tickets",staticStyle:{"font-size":"15px"}}),i("span",{staticStyle:{"font-size":"14px"}},[t._v(" å¿«æ·è¯­")])])])],1)],1),i("div",{staticClass:"mini-im-chat-input-edit",on:{keyup:[function(e){return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.keyUpEvent(e)},function(e){return!e.type.indexOf("key")&&13!==e.keyCode&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.shiftKey?t.enterShift(e):null},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.sendMessage(e)}]}},[i("el-input",{ref:"chatValueDom",staticClass:"mini-im-chat-text-input",attrs:{type:"textarea",rows:"3",resize:"none",autosize:!1,disabled:1==t.seviceCurrentUser.is_session_end||0==t.adminInfo.online,maxlength:"200","show-word-limit":"",placeholder:1==t.seviceCurrentUser.is_session_end?"å½“å‰ä¼šè¯å·²ç»“æŸ":"è¯·è¾“å…¥å†…å®¹"},model:{value:t.chatValue,callback:function(e){t.chatValue=e},expression:"chatValue"}})],1)])]),i("div",{staticClass:"mini-im-chat-view-user"},[i("el-tabs",{attrs:{type:"border-card"}},[i("el-tab-pane",{attrs:{label:"ç”¨æˆ·ä¿¡æ¯"}},[i("UserInfoComponent")],1)],1)],1)])]):i("div",{staticClass:"mini-im-chat-view no-window"},[t._m(0),i("span",[t._v("å½“å‰æ— å¯¹è¯")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.chatWindowLoading,expression:"chatWindowLoading"}],staticClass:"mini-im-right-window-loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[t._v("æ•°æ®åŠ è½½ä¸­...")])])]),i("CreateShortcutComponent",{attrs:{complete:t.getShortcuts,dialogFormVisible:t.createShortcutDialogFormVisible},on:{"update:dialogFormVisible":function(e){t.createShortcutDialogFormVisible=e},"update:dialog-form-visible":function(e){t.createShortcutDialogFormVisible=e}}}),i("EditShortcutComponent",{attrs:{formData:t.editShortcutItem,complete:t.getShortcuts,dialogFormVisible:t.editShortcutDialogFormVisible},on:{"update:dialogFormVisible":function(e){t.editShortcutDialogFormVisible=e},"update:dialog-form-visible":function(e){t.editShortcutDialogFormVisible=e}}})],1)},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("i",{staticClass:"el-icon-service"})])}],o=(i("1c01"),i("58b2"),i("8e6e"),i("f3e2"),i("ac6a"),i("456d"),i("c5f6"),i("4917"),i("a481"),i("6d67"),i("57e7"),i("d25f"),i("4f37"),i("85f2")),a=i.n(o);function r(t,e,i){return e in t?a()(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"}},[i("div",{staticClass:"emoji-box"},t._l(t.emojis,(function(e,s){return i("span",{key:s,on:{click:function(i){return t.clickEmoji(e)}}},[t._v(t._s(e))])})),0),i("button",{staticClass:"mini-im-button",staticStyle:{"font-size":"20px"},attrs:{slot:"reference",title:"é€‰æ‹©è¡¨æƒ…"},slot:"reference"},[t._v("ğŸ˜Š")])])},l=[],u=i("eef3"),m={name:"mini-im-emoji",data:function(){return{emojis:u.emojiData}},props:{clickEmoji:Function}},d=m,f=(i("1826"),i("2877")),h=Object(f["a"])(d,c,l,!1,null,"3d019866",null),v=h.exports,g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-im-chat-item"},[i("span",{staticClass:"delete_contact",attrs:{title:"åˆ é™¤è¯¥è®°å½•"},on:{"!click":function(e){return t.deleteContact(t.item)}}},[i("i",{staticClass:"el-icon-close"})]),i("el-avatar",{staticClass:"mini-im-avatar",on:{click:function(e){return t.clickItem(t.item)}}},[""!=t.item.avatar?i("img",{attrs:{src:t.item.avatar}}):[t._v("è®¿")]],2),i("div",{staticClass:"mini-im-message-box",on:{click:function(e){return t.clickItem(t.item)}}},[i("div",{staticClass:"mini-im-user-date"},[i("div",{staticClass:"mini-im-nickname"},[i("span",{staticClass:"mini-im-online-status",class:{success:1==t.item.online}},[t._v("â—")]),t._v(" "+t._s(t.item.nickname)+"\n          ")]),i("div",{staticClass:"mini-im-date"},[t._v("\n              "+t._s(t.$formatFromNowDate(t.item.contact_create_at))+"\n          ")])]),i("div",{staticClass:"mini-im-message-badge"},["text"==t.item.last_message_type?i("div",{staticClass:"mini-im-message"},[t._v(t._s(t.item.last_message))]):t._e(),"photo"==t.item.last_message_type?i("div",{staticClass:"mini-im-message"},[t._v("æ”¶åˆ°å›¾ç‰‡æ–‡ä»¶")]):t._e(),"video"==t.item.last_message_type?i("div",{staticClass:"mini-im-message"},[t._v("æ”¶åˆ°è§†é¢‘æ–‡ä»¶")]):t._e(),"end"==t.item.last_message_type?i("div",{staticClass:"mini-im-message"},[t._v("ä¼šè¯ç»“æŸ")]):t._e(),"cancel"==t.item.last_message_type?i("div",{staticClass:"mini-im-message"},[t._v("å¯¹æ–¹æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯")]):t._e(),"timeout"==t.item.last_message_type?i("div",{staticClass:"mini-im-message"},[t._v("ä¼šè¯è¶…æ—¶ï¼Œç»“æŸå¯¹è¯")]):t._e(),"transfer"==t.item.last_message_type||"handshake"==t.item.last_message_type?i("div",{staticClass:"mini-im-message"},[t._v("å®¢æœè½¬æ¥...")]):t._e(),t.item.read>0?i("div",{staticClass:"mini-im-badge"},[t._v(t._s(t.item.read))]):t._e()])])],1)},p=[],_={name:"mini-im-contact",data:function(){return{}},props:{item:Object,clickItem:Function,deleteContact:Function}},b=_,C=(i("297c"),Object(f["a"])(b,g,p,!1,null,"595d9a46",null)),y=C.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-im-username-component-box"},[i("div",{staticClass:"mini-im-username-component"},[i("button",{attrs:{title:"ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯"},on:{click:function(e){t.isUserReadonly=!t.isUserReadonly}}},[i("i",{staticClass:"el-icon-edit"})])]),i("el-form",{ref:"form",class:{"form-item-readonly":t.isUserReadonly},attrs:{"label-width":"80px"}},[i("el-form-item",{staticClass:"form-item",attrs:{label:"ç”¨æˆ·æ˜µç§°"}},[i("el-input",{attrs:{placeholder:"æ¸¸å®¢",readonly:t.isUserReadonly,type:"text"},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"æ‰€åœ¨åœ°åŒº"}},[i("el-input",{attrs:{readonly:t.isUserReadonly,placeholder:"æ— ",type:"text"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"è”ç³»æ–¹å¼"}},[i("el-input",{attrs:{readonly:t.isUserReadonly,placeholder:"æ— è”ç³»æ–¹å¼",type:"text"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),i("el-form-item",{staticClass:"form-item no-border",attrs:{label:"æ‰€åœ¨å¹³å°"}},[i("el-input",{attrs:{readonly:"",value:t.$getPlatformItem(t.user.platform).title,resize:"none",type:"text"}})],1),i("el-form-item",{staticClass:"form-item no-border",attrs:{label:"åˆ›å»ºæ—¶é—´"}},[i("el-input",{attrs:{readonly:"",value:t.$formatUnixDate(t.user.create_at,"YYYY/MM/DD"),resize:"none",type:"text"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"å¤‡æ³¨ä¿¡æ¯"}},[i("el-input",{attrs:{rows:"4",readonly:t.isUserReadonly,placeholder:"æ— å¤‡æ³¨",resize:"none",type:"textarea"},model:{value:t.form.remarks,callback:function(e){t.$set(t.form,"remarks",e)},expression:"form.remarks"}})],1),t.isUserReadonly?t._e():i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-button",{on:{click:function(e){t.isUserReadonly=!0}}},[t._v("å–æ¶ˆ")]),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("ä¿å­˜")])],1),t.isUserReadonly?t._e():i("div",{staticStyle:{"text-align":"center","font-size":"12px",color:"#666","margin-top":"15px"}},[t._v("å½“å‰ä¸ºç¼–è¾‘æ¨¡å¼")])],1)],1)},S=[],k=i("bc3a"),x=i.n(k),$={name:"mini-im-user-info",data:function(){return{form:{id:"",nickname:"",address:"",phone:"",remarks:""},isUserReadonly:!0}},computed:{user:function(){return this.$store.getters.seviceCurrentUser||{}}},methods:{save:function(){var t=this;x.a.put("/user",this.form).then((function(){t.isUserReadonly=!0})).catch((function(e){t.$message.error(e.response.data.message)}))}},watch:{user:function(t){t.id!=this.form.id&&(this.isUserReadonly=!0),(this.isUserReadonly||t.id!=this.form.id)&&(this.form=this.user)}}},I=$,M=(i("2b0b"),Object(f["a"])(I,w,S,!1,null,null,null)),U=M.exports,E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{width:"600px",title:"æ·»åŠ å¿«æ·è¯­","show-close":!1,visible:t.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"æ ‡é¢˜","label-width":t.formLabelWidth}},[i("el-input",{attrs:{maxlength:"50","show-word-limit":"",type:"text",placeholder:"è¯·è¾“å…¥æ ‡é¢˜",autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"å†…å®¹","label-width":t.formLabelWidth}},[i("el-input",{attrs:{rows:"8",resize:"none",autosize:!1,maxlength:"200","show-word-limit":"",type:"textarea",placeholder:"è¯·è¾“å…¥å¿«æ·è¯­",autocomplete:"off"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeModal}},[t._v("å– æ¶ˆ")]),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("ä¿ å­˜")])],1)],1)},T=[],O={name:"mini-im-create-shortcuts",data:function(){return{form:{content:"",title:""},formLabelWidth:"40px"}},props:{dialogFormVisible:Boolean,complete:Function},mounted:function(){},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},save:function(){var t=this;if(""!=this.form.title.trim()&&""!=this.form.content.trim()){var e=this.$loading({lock:!0,text:"ä¿å­˜ä¸­...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});x.a.post("/shortcut",this.form).then((function(i){try{console.log(i),e.close(),t.$message.success("æ·»åŠ æˆåŠŸ"),t.closeModal(),t.complete(),t.form={content:"",title:""}}catch(s){console.log(s)}})).catch((function(i){e.close(),t.$message.error(i.response.data.message)}))}}}},R=O,P=Object(f["a"])(R,E,T,!1,null,"ae51b748",null),L=P.exports,V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{width:"600px",title:"ç¼–è¾‘å¿«æ·è¯­","show-close":!1,visible:t.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"æ ‡é¢˜","label-width":t.formLabelWidth}},[i("el-input",{attrs:{maxlength:"50","show-word-limit":"",type:"text",placeholder:"è¯·è¾“å…¥æ ‡é¢˜",autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"å†…å®¹","label-width":t.formLabelWidth}},[i("el-input",{attrs:{rows:"8",resize:"none",autosize:!1,maxlength:"200","show-word-limit":"",type:"textarea",placeholder:"è¯·è¾“å…¥å¿«æ·è¯­",autocomplete:"off"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeModal}},[t._v("å– æ¶ˆ")]),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("ä¿ å­˜")])],1)],1)},N=[],F={name:"mini-im-edit-shortcuts",data:function(){return{form:{content:"",title:""},formLabelWidth:"40px"}},props:{dialogFormVisible:Boolean,complete:Function,formData:Object},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},save:function(){var t=this;if(""!=this.form.title.trim()&&""!=this.form.content.trim()){var e=this.$loading({lock:!0,text:"ä¿å­˜ä¸­...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});x.a.put("/shortcut",this.form).then((function(i){try{console.log(i),e.close(),t.$message.success("æ·»åŠ æˆåŠŸ"),t.closeModal(),t.complete()}catch(s){console.log(s)}})).catch((function(i){e.close(),t.$message.error(i.response.data.message)}))}}},watch:{formData:function(){this.form=Object.assign({},this.form,this.formData)}}},z=F,j=Object(f["a"])(z,V,N,!1,null,"3714045a",null),D=j.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-im-chat-list"},[i("div",{staticClass:"mini-im-chat-message-box"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[t._v("æ¶ˆæ¯åŠ è½½ä¸­...")])]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isMessageEnd,expression:"isMessageEnd"}],attrs:{type:"text",disabled:"",icon:"el-icon-refresh-right"}},[t._v("æ— æ›´å¤šèŠå¤©è®°å½•...")]),t.isMessageEnd||t.loading?t._e():i("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:t.onLoadMor}},[t._v("ç‚¹å‡»åŠ è½½æ›´å¤šèŠå¤©è®°å½•")])],1),i("div",{staticClass:"mini-im-chat-message-box"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.messages.length<=0&&!t.loading,expression:"messages.length <= 0 && !loading"}],staticClass:"loading"},[i("i",{staticClass:"el-icon-time"}),i("span",[t._v("æš‚æ— èŠå¤©è®°å½•...")])])]),t._l(t.messages,(function(e,s){return i("div",{key:s,staticClass:"mini-im-chat-message-box",class:{self:e.from_account!=t.seviceCurrentUser.id}},["text"==e.biz_type||"photo"==e.biz_type||"knowledge"==e.biz_type||"knowledge_list"==e.biz_type?[i("div",{staticClass:"user-date"},[e.from_account==t.adminInfo.id?i("span",[t._v("\n              "+t._s(t.adminInfo.nickname||t.adminInfo.username)+"\n            ")]):e.from_account==t.seviceCurrentUser.from_account?i("span",[t._v("\n              "+t._s(t.seviceCurrentUser.nickname)+"\n            ")]):i("span",[i("span",{staticStyle:{"font-size":"12px",color:"#666"}},[t._v("(æœºå™¨äºº)")]),t._v(t._s(t.$robotNickname(e.from_account))+"\n            ")]),i("em",[t._v(t._s(t.$formatFromNowDate(e.timestamp)))])])]:t._e(),"text"==e.biz_type?[i("div",{staticClass:"text"},[e.from_account==t.adminInfo.id&&e.isShowCancel?i("div",{staticClass:"cancel-btn",attrs:{title:"æ’¤å›æœ¬æ¡æ¶ˆæ¯"},on:{click:function(){return t.onCancelMessage(e.key)}}},[t._v("\n              æ’¤å›\n            ")]):t._e(),i("span",{domProps:{innerHTML:t._s(e.payload.replace(/\n/gi,"<br />"))}})])]:t._e(),"photo"==e.biz_type?[i("div",{staticClass:"photo"},[e.percent&&100!=e.percent?i("div",{staticClass:"loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[t._v(t._s(e.percent)+"%")])]):t._e(),e.from_account==t.adminInfo.id&&e.isShowCancel?i("div",{staticClass:"cancel-btn",attrs:{title:"æ’¤å›æœ¬æ¡æ¶ˆæ¯"},on:{click:function(){return t.onCancelMessage(e.key)}}},[t._v("\n              æ’¤å›\n            ")]):t._e(),i("div",{staticClass:"img-content"},[i("img",{attrs:{src:e.payload,preview:"1"}})])])]:t._e(),"transfer"==e.biz_type?[i("div",{staticClass:"system"},[i("em",[t._v(t._s(t.$formatFromNowDate(e.timestamp)))]),i("span",[t._v(t._s(e.payload))])])]:t._e(),"end"==e.biz_type?[i("div",{staticClass:"system"},[i("em",[t._v(t._s(t.$formatFromNowDate(e.timestamp)))]),e.to_account!=t.adminInfo.id?i("span",[t._v("ä½ ç»“æŸäº†ä¼šè¯")]):i("span",[t._v("å¯¹æ–¹ç»“æŸäº†ä¼šè¯")]),i("em",[t._v(t._s(t.$formatFromNowDate(e.timestamp)))])])]:t._e(),"timeout"==e.biz_type?[i("div",{staticClass:"system"},[i("em",[t._v(t._s(t.$formatFromNowDate(e.timestamp)))]),i("span",[t._v("ç”¨æˆ·é•¿æ—¶é—´æ— åº”ç­”ï¼Œä¼šè¯ç»“æŸ")])])]:t._e(),"cancel"==e.biz_type?[i("div",{staticClass:"system"},[i("em",[t._v(t._s(t.$formatFromNowDate(e.timestamp)))]),e.from_account==t.adminInfo.id?i("span",[t._v("æ‚¨æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯")]):i("span",[t._v("å¯¹æ–¹æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯")])])]:t._e(),"knowledge"==e.biz_type?[i("div",{staticClass:"knowledge"},[i("div",{staticClass:"content"},[i("div",{staticClass:"title"},[t._v("ä»¥ä¸‹æ˜¯å¦æ˜¯æ‚¨å…³å¿ƒçš„ç›¸å…³é—®é¢˜å‘¢ï¼Ÿ")]),t._l(JSON.parse(e.payload),(function(e,s){return i("div",{key:s,staticClass:"item"},[t._v("\n                "+t._s(s+1)+"."+t._s(e.title)+"\n              ")])}))],2)])]:t._e()],2)}))],2)},B=[],G={name:"mini-im-contact",data:function(){return{}},computed:{seviceCurrentUser:function(){return this.$store.getters.seviceCurrentUser||{}},adminInfo:function(){return this.$store.getters.adminInfo||{}}},props:{loading:Boolean,onCancelMessage:Function,messages:Array,onLoadMor:Function,isMessageEnd:Boolean},watch:{messages:function(){var t=this;setTimeout((function(){t.$previewRefresh()}),1e3)}}},K=G,W=(i("24fd"),Object(f["a"])(K,A,B,!1,null,"019193ce",null)),H=W.exports,J=i("fb21"),Y=i("b730"),q=i.n(Y),X=i("2f62");function Q(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function Z(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(i),!0).forEach((function(e){r(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Q(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var tt={name:"workbench",components:{EmojiComponent:v,ContactComponent:y,UserInfoComponent:U,ChatWindowComponent:H,CreateShortcutComponent:L,EditShortcutComponent:D},data:function(){return{chatValue:"",advanceText:"",admins:[],shortcuts:[],shortcutKey:"",createShortcutDialogFormVisible:!1,editShortcutDialogFormVisible:!1,editShortcutItem:null,shortcutEditVisible:!1,getMessageRecordLoading:!0,chatWindowLoading:!1,currentSessionIsEnd:!1,getMessageRecordPageSize:20,isInputPongIng:!1,isSendPong:!1,inputPongIngString:"å¯¹æ–¹æ­£åœ¨è¾“å…¥...",isPush:!1,isMessageEnd:!1}},computed:Z({filterShortcuts:function(){var t=this.shortcutKey.trim();return""!=t?this.shortcuts.filter((function(e){return-1!=e.title.indexOf(t)})):this.shortcuts},filterAdmins:function(){var t=this;return this.admins.filter((function(e){return e.id!=t.adminInfo.id&&(1==e.online||2==e.online)}))}},Object(X["b"])(["contacts","adminInfo","seviceCurrentUser","messageRecord"])),mounted:function(){var t,e=this;document.ondblclick=function(){e.shortcutEditVisible=!1},this.init(),document.addEventListener("mousemove",(function(){e.$refs.miniImChatViewBontentBody&&(e.$refs.miniImChatViewBontentBody.style.height=document.body.clientHeight-155+"px"),e.isPush=!1,t&&clearTimeout(t),t=setTimeout((function(){e.isPush=!0}),3e4)})),document.addEventListener("paste",this.inputPaste,!1)},beforeDestroy:function(){this.changeCurrentUser()},methods:{init:function(){var t=this;if(!this.adminInfo)return this.$store.dispatch("ON_GET_ME"),void setTimeout((function(){return t.init()}),100);this.getShortcuts(),this.chatWindowLoading=!0,setTimeout((function(){t.chatWindowLoading=!1}),1500),setTimeout((function(){var e,i=t.$store.getters.seviceCurrentUser.id||t.$route.query.uid;(t.changeCurrentUser(i||0),i)&&(t.contacts.map((function(t){t.from_account==i&&(e=t)})),history.replaceState(null,null,location.href.replace(/uid=\d+/i,"uid="+i)),t.$store.commit("onChangeSeviceCurrentUser",e),e&&t.selectUser(e),t.getMessageRecord(),t.scrollIntoBottom())}),1e3),this.$mimcInstance.addEventListener("statusChange",(function(e){1==t.adminInfo.online?t.$message.success("æ‚¨å½“å‰çŠ¶æ€ä¸ºåœ¨çº¿"):2==t.adminInfo.online&&t.$message.warning("æ‚¨å½“å‰çŠ¶æ€ä¸ºç¹å¿™"),e||t.$store.dispatch("ON_GET_ME").then((function(){0!=t.adminInfo.online&&t.init()}))})),this.$mimcInstance.addEventListener("receiveP2PMsg",this.receiveP2PMsg),this.$mimcInstance.addEventListener("disconnect",(function(){console.log("é“¾æ¥æ–­å¼€ï¼");var e=t.adminInfo;0!=e.online?(t.adminInfo=null,t.init()):(e.online=0,t.$store.commit("onChangeAdminInfo",e))}))},enterShift:function(t){"Enter"!=t.code&&(this.chatValue=this.chatValue+"\n")},scrollIntoBottom:function(){try{setTimeout((function(){var t=document.getElementById("chatBody");if(t){var e=t.clientHeight,i=t.scrollHeight;t.scrollTop=i-e}}),50)}catch(t){console.log(t)}},deleteContact:function(t){var e=this;t&&t.cid&&x.a.delete("/contact/"+t.cid).then((function(){e.$message.success("åˆ é™¤æˆåŠŸ"),e.$store.dispatch("ON_GET_CONTACTS"),e.seviceCurrentUser.id==t.id&&(e.changeCurrentUser(),e.$store.commit("onChangeSeviceCurrentUser",null))})).catch((function(t){e.$message.error(t.response.data.message)}))},clearContact:function(){var t=this;this.$confirm("æ‚¨ç¡®å®šè¦æ¸…ç©ºåˆ—è¡¨å—? ","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){x.a.delete("/contact/clear").then((function(){t.$message.success("æ¸…ç©ºæˆåŠŸ"),t.$store.dispatch("ON_GET_CONTACTS"),t.changeCurrentUser(),t.$store.commit("onChangeSeviceCurrentUser",null)})).catch((function(e){t.$message.error(e.response.data.message)}))}))},clickEmoji:function(t){0!=this.adminInfo.online?1!=this.seviceCurrentUser.is_session_end?(this.chatValue=this.chatValue+t,this.$refs.chatValueDom.focus()):this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼"):this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},checkShortcut:function(t){0!=this.adminInfo.online?1!=this.seviceCurrentUser.is_session_end?(this.shortcutKey="",this.chatValue=t,this.$refs.chatValueDom.focus()):this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼"):this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},getShortcuts:function(){var t=this;x.a.get("/shortcut/list").then((function(e){t.shortcuts=e.data.data})).catch((function(e){t.$message.error(e.response.data.message)}))},editShortcut:function(t){this.editShortcutItem=t,this.editShortcutDialogFormVisible=!0},getAdmins:function(){var t=this;x.a.post("/admin/list",{page_on:1,page_size:1e4,online:3}).then((function(e){t.loading=!1,t.admins=e.data.data.list})).catch((function(e){t.$message.error(e.response.data.message)}))},deleteShortcut:function(t){var e=this;this.$confirm("æ‚¨ç¡®å®šè¦åˆ é™¤è¯¥å¿«æ·è¯­å—?","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){x.a.delete("/shortcut/"+t.id).then((function(){e.$message.success("åˆ é™¤æˆåŠŸ"),e.getShortcuts()})).catch((function(t){e.$message.error(t.response.data.message)}))}))},onCancelMessage:function(t){var e=this.$mimcInstance.sendMessage("cancel",this.seviceCurrentUser.from_account,t);this.messageRecord.list.push(e),this.removeMessage(this.adminInfo.id,t),this.qiniuObservable&&this.qiniuObservable.unsubscribe()},transferCustomer:function(t){var e=this;this.$confirm("æ‚¨ç¡®å®šå°†è¯¥å®¢æˆ·è½¬æ¥ç»™ "+(t.nickname||t.username)+" å—?","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"è½¬æ¥",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){x.a.post("/message/transfer",{to_account:t.id,user_account:e.seviceCurrentUser.from_account}).then((function(){var t=e.seviceCurrentUser;t.is_session_end=1,e.$store.commit("onChangeSeviceCurrentUser",t)})).catch((function(t){e.$message.error(t.response.data.message)}))}))},closeSession:function(){var t=this;this.$confirm("æ‚¨ç¡®å®šç»“æŸå½“å‰ä¼šè¯å—?å¼ºåˆ¶ç»“æŸå¯èƒ½ä¼šè¢«å®¢æˆ·æŠ•è¯‰ï¼","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"ç»“æŸ",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){var e=t.$mimcInstance.sendMessage("end",t.seviceCurrentUser.from_account,"");t.messageRecord.list.push(e);var i=t.seviceCurrentUser;i.is_session_end=1,t.$store.commit("onChangeSeviceCurrentUser",i)}))},changeUserOnlineStatus:function(t){var e=this;x.a.put("/admin/online/"+t).then((function(){e.$store.dispatch("ON_GET_ME"),0==t&&e.$message.info("å½“å‰çŠ¶æ€ä¸ºç¦»çº¿")})).catch((function(t){e.$message.error(t.response.data.message)}))},online:function(t){var e=this;e.adminInfo.online!=t&&e.$confirm("æ‚¨ç¡®å®š"+(0==t?"ä¸‹çº¿":1==t?"ä¸Šçº¿":"è®¾ç½®ç¹å¿™")+"å—ï¼","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){0==t?(e.$mimcInstance.logout(),e.changeUserOnlineStatus(t),e.$store.commit("onChangeMimcUser",null)):e.$mimcInstance.login((function(){e.changeUserOnlineStatus(t),e.$store.dispatch("ON_RUN_LAST_ACTiIVITY"),e.$store.dispatch("ON_GET_CONTACTS"),e.$store.commit("onChangeMimcUser",e.$mimcInstance.user)}))}))},receiveP2PMsg:function(t){var e=this,i=parseInt(((new Date).getTime()+"").substr(0,10));if(t.timestamp=parseInt((t.timestamp+"").substr(0,10)),(t.from_account!=this.adminInfo.id||"pong"!=t.biz_type)&&"into"!=t.biz_type){if(t.from_account==this.adminInfo.id&&this.seviceCurrentUser.from_account==t.to_account)return this.messageRecord.list.push(t),"cancel"==t.biz_type&&this.removeMessage(t.from_account,t.payload),this.scrollIntoBottom(),void this.$previewRefresh();if("text"==t.biz_type&&t.from_account==this.seviceCurrentUser.from_account&&(this.advanceText=""),"contacts"!=t.biz_type){if(!(i-t.timestamp>=60))if("cancel"==t.biz_type&&this.removeMessage(t.from_account,t.payload),"handshake"!=t.biz_type){if("pong"==t.biz_type&&t.from_account==this.seviceCurrentUser.from_account)return this.advanceText=t.payload,void this.inputPongIng();if("contacts"!=t.biz_type&&"pong"!=t.biz_type&&"welcome"!=t.biz_type&&"cancel"!=t.biz_type&&"handshake"!=t.biz_type&&"end"!=t.biz_type&&"timeout"!=t.biz_type&&this.isPush&&q.a.Permission.has()&&q.a.create("æ”¶åˆ°ä¸€æ¡æ–°æ¶ˆæ¯",{body:t.payload,icon:this.$store.state.pushIcon,timeout:5e3,onClick:function(){e.$router.push({path:"/workbench?uid="+t.from_account}),window.focus(),setTimeout((function(){return e.getMessageRecord()}),1e3)}}),t.from_account==this.seviceCurrentUser.from_account){if("end"==t.biz_type){var s=this.seviceCurrentUser;s.is_session_end=1,this.$store.commit("onChangeSeviceCurrentUser",s),this.advanceText=""}this.messageRecord.list.push(t);var n=JSON.stringify(this.messageRecord);this.$store.commit("onChangeMessageRecord",JSON.parse(n)),this.scrollIntoBottom(),this.$previewRefresh()}}else setTimeout((function(){e.$mimcInstance.sendMessage("text",t.from_account,e.adminInfo.auto_reply),void 0!=e.seviceCurrentUser&&null!=e.seviceCurrentUser&&setTimeout((function(){return e.getMessageRecord()}),1e3)}),500)}else{var o=JSON.parse(t.payload);this.$store.commit("onChangeContacts",o)}}},changeCurrentUser:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;"{}"!=JSON.stringify(this.adminInfo)&&x.a.get("/admin/current/user/"+t)},sendMessage:function(){if(0!=this.adminInfo.online){if(1!=this.seviceCurrentUser.is_session_end)if(1!=this.seviceCurrentUser.is_session_end){var t=this.chatValue.trim();if(""!=t){this.shortcutEditVisible=!1,this.scrollIntoBottom();var e=this.$mimcInstance.sendMessage("text",this.seviceCurrentUser.from_account,this.chatValue.trim("\n"));e.isShowCancel=!0,setTimeout((function(){return e.isShowCancel=!1}),1e4),this.messageRecord.list.push(e),this.chatValue=""}else this.chatValue=""}else this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼")}else this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},sendPhotoMessageEvent:function(t){var e=t.target,i=e.files[0];this.sendPhotoMessage(i)},sendPhotoMessage:function(t){if(0!=this.adminInfo.online)if(1!=this.seviceCurrentUser.is_session_end){var e=new FileReader;e.readAsDataURL(t);var i,s=this;e.onload=function(){i=s.$mimcInstance.createLocalMessage("photo",s.seviceCurrentUser.from_account,this.result),i["percent"]=0,i.isShowCancel=!0,s.messageRecord.list.push(i),setTimeout((function(){return i.isShowCancel=!1}),1e4),s.$previewRefresh(),s.scrollIntoBottom(),Object(J["a"])({file:t,progress:function(t){i.percent=t},success:function(t){i.percent=100;var e=s.$store.getters.uploadToken.host+"/"+t;s.$mimcInstance.sendMessage("photo",s.seviceCurrentUser.from_account,e)},error:function(t){i.percent=0,s.$message.error(t.message)}})}}else this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼");else this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},selectUser:function(t){var e=location.href,i=e.indexOf("#");e=e.substr(0,-1!=i?i:e.length),history.replaceState(null,null,e+"#/workbench?uid="+t.from_account),this.isMessageEnd=!1,this.seviceCurrentUser.from_account!=t.from_account&&(this.messageRecord.list=[],this.$store.commit("onChangeSeviceCurrentUser",t),this.changeCurrentUser(t.from_account)),this.timestamp=void 0,this.getMessageRecord(),this.advanceText=""},getMessageRecord:function(t){var e=this;this.getMessageRecordLoading=!0,void 0==t&&(t=0);var i=parseInt(this.seviceCurrentUser.from_account);i&&x.a.post("/message/list",{timestamp:t,page_size:this.getMessageRecordPageSize,account:i}).then((function(i){e.getMessageRecordLoading=!1,i.data.data.list.length<e.getMessageRecordPageSize&&(e.isMessageEnd=!0),0==e.messageRecord.list.length||0==t?(e.$store.commit("onChangeMessageRecord",i.data.data),e.scrollIntoBottom()):(i.data.data.list=i.data.data.list.concat(e.messageRecord.list),e.$store.commit("onChangeMessageRecord",i.data.data)),setTimeout((function(){return e.$previewRefresh()}),1e3),e.$store.dispatch("ON_GET_CONTACTS")})).catch((function(){e.getMessageRecordLoading=!1}))},onLoadMorMessage:function(){this.getMessageRecordLoading||(this.messageRecord.list.length>=this.messageRecord.total||this.messageRecord.total<=this.getMessageRecordPageSize?this.isMessageEnd=!0:(this.getMessageRecord(this.messageRecord.list[0].timestamp),setTimeout((function(){var t=document.getElementById("chatBody");t.scrollTop=500}),50)))},inputPongIng:function(){var t=this;this.isInputPongIng||(this.isInputPongIng=!0,setTimeout((function(){t.inputPongIngString="å¯¹æ–¹æ­£åœ¨è¾“å…¥."}),500),setTimeout((function(){t.inputPongIngString="å¯¹æ–¹æ­£åœ¨è¾“å…¥.."}),1500),setTimeout((function(){t.inputPongIngString="å¯¹æ–¹æ­£åœ¨è¾“å…¥...",t.isInputPongIng=!1}),3e3))},keyUpEvent:function(){var t=this;this.isSendPong||(this.isSendPong=!0,setTimeout((function(){return t.isSendPong=!1}),500),this.$mimcInstance.sendMessage("pong",this.seviceCurrentUser.from_account,""))},removeMessage:function(t,e){for(var i=[],s=this.messageRecord.list,n=0;n<s.length;n++)s[n].key==e&&s[n].from_account==t||i.push(s[n]);this.messageRecord.list=i,this.$store.commit("onChangeMessageRecord",this.messageRecord)},inputPaste:function(t){if(this.seviceCurrentUser.id&&1!=this.seviceCurrentUser.is_session_end){var e=this,i=t.clipboardData,s=window.navigator.userAgent;if(t.clipboardData&&t.clipboardData.items&&!(i.items&&2===i.items.length&&"string"===i.items[0].kind&&"file"===i.items[1].kind&&i.types&&2===i.types.length&&"text/plain"===i.types[0]&&"Files"===i.types[1]&&s.match(/Macintosh/i)&&Number(s.match(/Chrome\/(\d{2})/i)[1])<49))for(var n=0;n<i.items.length;n++){var o=i.items[n];if("file"==o.kind){var a=o.getAsFile();if(0===a.size)return;var r=new FileReader;r.readAsDataURL(a),r.onload=function(){var t=this.result;e.$alert('<img preview="1" style="width:100%;max-height: 500px;" src="'+t+'" />',"æ£€æµ‹åˆ°å›¾ç‰‡æ˜¯å¦è¦å‘é€ï¼Ÿ",{dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"å‘é€"}).then((function(){e.sendPhotoMessage(a)})),e.$previewRefresh()}}}}}},watch:{messageRecord:function(){this.$previewRefresh()}}},et=tt,it=(i("4cc3"),Object(f["a"])(et,s,n,!1,null,"3486f320",null));e["default"]=it.exports},"2b0b":function(t,e,i){"use strict";var s=i("752b"),n=i.n(s);n.a},"454f":function(t,e,i){i("46a7");var s=i("584a").Object;t.exports=function(t,e,i){return s.defineProperty(t,e,i)}},"456d":function(t,e,i){var s=i("4bf8"),n=i("0d58");i("5eda")("keys",(function(){return function(t){return n(s(t))}}))},"46a7":function(t,e,i){var s=i("63b6");s(s.S+s.F*!i("8e60"),"Object",{defineProperty:i("d9f6").f})},4917:function(t,e,i){"use strict";var s=i("cb7c"),n=i("9def"),o=i("0390"),a=i("5f1b");i("214f")("match",1,(function(t,e,i,r){return[function(i){var s=t(this),n=void 0==i?void 0:i[e];return void 0!==n?n.call(i,s):new RegExp(i)[e](String(s))},function(t){var e=r(i,t,this);if(e.done)return e.value;var c=s(t),l=String(this);if(!c.global)return a(c,l);var u=c.unicode;c.lastIndex=0;var m,d=[],f=0;while(null!==(m=a(c,l))){var h=String(m[0]);d[f]=h,""===h&&(c.lastIndex=o(l,n(c.lastIndex),u)),f++}return 0===f?null:d}]}))},"4cc3":function(t,e,i){"use strict";var s=i("7f7c"),n=i.n(s);n.a},"4e10":function(t,e,i){},"4f37":function(t,e,i){"use strict";i("aa77")("trim",(function(t){return function(){return t(this,3)}}))},"58b2":function(t,e,i){var s=i("5ca1");s(s.S+s.F*!i("9e1e"),"Object",{defineProperties:i("1495")})},"5dbc":function(t,e,i){var s=i("d3f4"),n=i("8b97").set;t.exports=function(t,e,i){var o,a=e.constructor;return a!==i&&"function"==typeof a&&(o=a.prototype)!==i.prototype&&s(o)&&n&&n(t,o),t}},"5eda":function(t,e,i){var s=i("5ca1"),n=i("8378"),o=i("79e5");t.exports=function(t,e){var i=(n.Object||{})[t]||Object[t],a={};a[t]=e(i),s(s.S+s.F*o((function(){i(1)})),"Object",a)}},"752b":function(t,e,i){},"7f7c":function(t,e,i){},"85f2":function(t,e,i){t.exports=i("454f")},"8b97":function(t,e,i){var s=i("d3f4"),n=i("cb7c"),o=function(t,e){if(n(t),!s(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,s){try{s=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),s(t,[]),e=!(t instanceof Array)}catch(n){e=!0}return function(t,i){return o(t,i),e?t.__proto__=i:s(t,i),t}}({},!1):void 0),check:o}},"8e6e":function(t,e,i){var s=i("5ca1"),n=i("990b"),o=i("6821"),a=i("11e9"),r=i("f1ae");s(s.S,"Object",{getOwnPropertyDescriptors:function(t){var e,i,s=o(t),c=a.f,l=n(s),u={},m=0;while(l.length>m)i=c(s,e=l[m++]),void 0!==i&&r(u,e,i);return u}})},9093:function(t,e,i){var s=i("ce10"),n=i("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return s(t,n)}},"990b":function(t,e,i){var s=i("9093"),n=i("2621"),o=i("cb7c"),a=i("7726").Reflect;t.exports=a&&a.ownKeys||function(t){var e=s.f(o(t)),i=n.f;return i?e.concat(i(t)):e}},a481:function(t,e,i){"use strict";var s=i("cb7c"),n=i("4bf8"),o=i("9def"),a=i("4588"),r=i("0390"),c=i("5f1b"),l=Math.max,u=Math.min,m=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,h=function(t){return void 0===t?t:String(t)};i("214f")("replace",2,(function(t,e,i,v){return[function(s,n){var o=t(this),a=void 0==s?void 0:s[e];return void 0!==a?a.call(s,o,n):i.call(String(o),s,n)},function(t,e){var n=v(i,t,this,e);if(n.done)return n.value;var m=s(t),d=String(this),f="function"===typeof e;f||(e=String(e));var p=m.global;if(p){var _=m.unicode;m.lastIndex=0}var b=[];while(1){var C=c(m,d);if(null===C)break;if(b.push(C),!p)break;var y=String(C[0]);""===y&&(m.lastIndex=r(d,o(m.lastIndex),_))}for(var w="",S=0,k=0;k<b.length;k++){C=b[k];for(var x=String(C[0]),$=l(u(a(C.index),d.length),0),I=[],M=1;M<C.length;M++)I.push(h(C[M]));var U=C.groups;if(f){var E=[x].concat(I,$,d);void 0!==U&&E.push(U);var T=String(e.apply(void 0,E))}else T=g(x,d,$,I,U,e);$>=S&&(w+=d.slice(S,$)+T,S=$+x.length)}return w+d.slice(S)}];function g(t,e,s,o,a,r){var c=s+t.length,l=o.length,u=f;return void 0!==a&&(a=n(a),u=d),i.call(r,u,(function(i,n){var r;switch(n.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,s);case"'":return e.slice(c);case"<":r=a[n.slice(1,-1)];break;default:var u=+n;if(0===u)return i;if(u>l){var d=m(u/10);return 0===d?i:d<=l?void 0===o[d-1]?n.charAt(1):o[d-1]+n.charAt(1):i}r=o[u-1]}return void 0===r?"":r}))}}))},aa77:function(t,e,i){var s=i("5ca1"),n=i("be13"),o=i("79e5"),a=i("fdef"),r="["+a+"]",c="â€‹Â…",l=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),m=function(t,e,i){var n={},r=o((function(){return!!a[t]()||c[t]()!=c})),l=n[t]=r?e(d):a[t];i&&(n[i]=l),s(s.P+s.F*r,"String",n)},d=m.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=m},ac6a:function(t,e,i){for(var s=i("cadf"),n=i("0d58"),o=i("2aba"),a=i("7726"),r=i("32e9"),c=i("84f2"),l=i("2b4c"),u=l("iterator"),m=l("toStringTag"),d=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=n(f),v=0;v<h.length;v++){var g,p=h[v],_=f[p],b=a[p],C=b&&b.prototype;if(C&&(C[u]||r(C,u,d),C[m]||r(C,m,p),c[p]=d,_))for(g in s)C[g]||o(C,g,s[g],!0)}},c5f6:function(t,e,i){"use strict";var s=i("7726"),n=i("69a8"),o=i("2d95"),a=i("5dbc"),r=i("6a99"),c=i("79e5"),l=i("9093").f,u=i("11e9").f,m=i("86cc").f,d=i("aa77").trim,f="Number",h=s[f],v=h,g=h.prototype,p=o(i("2aeb")(g))==f,_="trim"in String.prototype,b=function(t){var e=r(t,!1);if("string"==typeof e&&e.length>2){e=_?e.trim():d(e,3);var i,s,n,o=e.charCodeAt(0);if(43===o||45===o){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:s=2,n=49;break;case 79:case 111:s=8,n=55;break;default:return+e}for(var a,c=e.slice(2),l=0,u=c.length;l<u;l++)if(a=c.charCodeAt(l),a<48||a>n)return NaN;return parseInt(c,s)}}return+e};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof h&&(p?c((function(){g.valueOf.call(i)})):o(i)!=f)?a(new v(b(e)),i,h):b(e)};for(var C,y=i("9e1e")?l(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;y.length>w;w++)n(v,C=y[w])&&!n(h,C)&&m(h,C,u(v,C));h.prototype=g,g.constructor=h,i("2aba")(s,f,h)}},d25f:function(t,e,i){"use strict";var s=i("5ca1"),n=i("0a49")(2);s(s.P+s.F*!i("2f21")([].filter,!0),"Array",{filter:function(t){return n(this,t,arguments[1])}})},eef3:function(t,e){var i=["ğŸ˜€","ğŸ˜","ğŸ˜‚","ğŸ¤£","ğŸ˜ƒ","ğŸ˜„","ğŸ˜…","ğŸ˜†","ğŸ˜‰","ğŸ˜Š","ğŸ˜‹","ğŸ˜","ğŸ˜","ğŸ˜˜","ğŸ˜—","ğŸ˜™","ğŸ˜š","ğŸ™‚","ğŸ¤—","ğŸ¤©","ğŸ¤”","ğŸ¤¨","ğŸ˜","ğŸ˜‘","ğŸ˜¶","ğŸ™„","ğŸ˜","ğŸ˜£","ğŸ˜¥","ğŸ˜®","ğŸ¤","ğŸ˜¯","ğŸ˜ª","ğŸ˜«","ğŸ˜´","ğŸ˜Œ","ğŸ˜›","ğŸ˜œ","ğŸ˜","ğŸ¤¤","ğŸ˜’","ğŸ˜“","ğŸ˜”","ğŸ˜•","ğŸ™ƒ","ğŸ¤‘","ğŸ˜²","ğŸ™","ğŸ˜–","ğŸ˜","ğŸ˜Ÿ","ğŸ˜¤","ğŸ˜¢","ğŸ˜­","ğŸ˜¦","ğŸ˜§","ğŸ˜¨","ğŸ˜©","ğŸ¤¯","ğŸ˜¬","ğŸ˜°","ğŸ˜±","ğŸ˜³","ğŸ¤ª","ğŸ˜µ","ğŸ˜¡","ğŸ˜ ","ğŸ¤¬","ğŸ˜·","ğŸ¤’","ğŸ¤•","ğŸ¤¢","ğŸ¤®","ğŸ¤§","ğŸ˜‡","ğŸ¤ ","ğŸ¤¡","ğŸ¤¥","ğŸ¤«","ğŸ¤­","ğŸ§","ğŸ¤“","ğŸ˜ˆ","ğŸ‘¿","ğŸ‘¹","ğŸ‘º","ğŸ’€","ğŸ‘»","ğŸ‘½","ğŸ¤–","ğŸ’©","ğŸ˜º","ğŸ˜¸","ğŸ˜¹","ğŸ˜»","ğŸ˜¼","ğŸ˜½","ğŸ™€","ğŸ˜¿","ğŸ˜¾","ğŸ¤²","ğŸ‘","ğŸ™Œ","ğŸ‘","ğŸ¤","ğŸ‘","ğŸ‘","ğŸ‘Š","âœŠ","ğŸ¤›","ğŸ¤œ","ğŸ¤","âœŒï¸","ğŸ¤Ÿ","ğŸ¤˜","ğŸ‘Œ","ğŸ‘ˆ","ğŸ‘‰","ğŸ‘†","ğŸ‘‡","â˜ï¸","âœ‹","ğŸ¤š","ğŸ–","ğŸ––","ğŸ‘‹","ğŸ¤™","ğŸ’ª","ğŸ–•","âœï¸","ğŸ™"];e.emojiData=i},f1ae:function(t,e,i){"use strict";var s=i("86cc"),n=i("4630");t.exports=function(t,e,i){e in t?s.f(t,e,n(0,i)):t[e]=i}},f3e2:function(t,e,i){"use strict";var s=i("5ca1"),n=i("0a49")(0),o=i("2f21")([].forEach,!0);s(s.P+s.F*!o,"Array",{forEach:function(t){return n(this,t,arguments[1])}})},fa4e:function(t,e,i){},fdef:function(t,e){t.exports="\t\n\v\f\r Â áš€á â€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-4033950c.00c35915.js.map