(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56896308"],{4468:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"mini-im-head"},[a("span",[a("i",{staticClass:"el-icon-user"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("用户管理")])])]),a("el-divider"),a("div",{staticClass:"search"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticStyle:{width:"120px"}},[a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"按条件查找："}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"请选择平台"},model:{value:e.tableData.platform,callback:function(t){e.$set(e.tableData,"platform",t)},expression:"tableData.platform"}},e._l(e.platformConfig,(function(e){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),1)],1),a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请输入关键词","prefix-icon":"el-icon-search",clearable:""},model:{value:e.tableData.keyword,callback:function(t){e.$set(e.tableData,"keyword",t)},expression:"tableData.keyword"}})],1),a("el-col",{attrs:{span:6.5}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.selectDate,callback:function(t){e.selectDate=t},expression:"selectDate"}})],1),a("el-col",{attrs:{span:3}},[a("el-button",{on:{click:e.search}},[e._v("查 找")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData.list}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"#序号",width:"60"}}),a("el-table-column",{attrs:{prop:"avatar",label:"头像",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-avatar",{attrs:{size:40,src:t.row.avatar||e.$store.state.avatar}})]}}])}),a("el-table-column",{attrs:{prop:"nickname",label:"用户昵称"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!=t.row.nickname?a("span",[e._v(e._s(t.row.nickname))]):a("span",[e._v("------")])]}}])}),a("el-table-column",{attrs:{prop:"uid",label:"业务平台ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!=t.row.uid?a("span",[e._v(e._s(t.row.uid))]):a("span",[e._v("------")])]}}])}),a("el-table-column",{attrs:{prop:"address",label:"所在地区"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!=t.row.address?a("span",[e._v(e._s(t.row.address))]):a("span",[e._v("------")])]}}])}),a("el-table-column",{attrs:{prop:"phone",label:"联系方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[""!=t.row.phone?a("span",[e._v(e._s(t.row.phone))]):a("span",[e._v("------")])]}}])}),a("el-table-column",{attrs:{prop:"online",align:"center",label:"在线状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.online?a("el-tag",{attrs:{type:"success"}},[e._v("在线")]):e._e(),0==t.row.online?a("el-tag",{attrs:{type:"info"}},[e._v("离线")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"platform",align:"center",label:"服务平台"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(e.$getPlatformItem(t.row.platform).title))])]}}])}),a("el-table-column",{attrs:{prop:"remarks",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.remarks||"------")+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"create_at",label:"注册时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.$formatUnixDate(t.row.create_at,"YYYY/MM/DD"))+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"operating",align:"center",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.edit(t.row)}}},[e._v("编 辑")]),1==e.$store.getters.adminInfo.root?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteUser(t.row)}}},[e._v("删 除")]):e._e()]}}])})],1),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"space-between"}},[a("span",{staticStyle:{color:"#666","font-size":"14px"}},[e._v("共找到"+e._s(e.tableData.total)+"条数据")]),a("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next","current-page":e.tableData.page_on,"page-sizes":[5,10,15,20],total:e.tableData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("EditDialog",{attrs:{complete:e.getUsers,formData:e.editItem,dialogFormVisible:e.editDialogFormVisible},on:{"update:dialogFormVisible":function(t){e.editDialogFormVisible=t},"update:dialog-form-visible":function(t){e.editDialogFormVisible=t}}})],1)},l=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"编辑用户","show-close":!1,visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"头像","label-width":e.formLabelWidth}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"mini-im-file-button",attrs:{title:"点击上传图片"}},[a("el-avatar",{attrs:{size:50,src:e.form.avatar||e.$store.state.avatar}}),a("input",{attrs:{onClick:"this.value = null",type:"file",accept:"image/*"},on:{change:e.changeFile}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isUploading,expression:"isUploading"}],staticClass:"mini-im-file-percent"},[a("span",[e._v(e._s(e.uploadPercent))])])],1)]),a("el-col",{attrs:{span:6}})],1)],1),a("el-form-item",{attrs:{label:"用户昵称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入用户昵称",autocomplete:"off"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),a("el-form-item",{attrs:{label:"所在地区","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入所在地区",autocomplete:"off"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),a("el-form-item",{attrs:{label:"联系方式","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入联系方式",autocomplete:"off"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),a("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注",autocomplete:"off"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeModal}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保 存")])],1)],1)},n=[],r=a("bc3a"),i=a.n(r),c=a("fb21"),d={name:"mini-im-edit-user",data:function(){return{form:{id:"",avatar:"",phone:"",address:"",nickname:"",remarks:""},formLabelWidth:"120px",isUploading:!1,uploadPercent:""}},props:{dialogFormVisible:Boolean,complete:Function,formData:Object},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},changeFile:function(e){var t=this,a=e.target.files[0];Object(c["a"])({file:a,progress:function(e){t.isUploading=!0,t.uploadPercent=e+"%"},success:function(e){t.isUploading=!1,t.uploadPercent="",t.$message.success("上传成功");var a=t.$store.getters.configs.upload_host+"/"+e;t.form.avatar=a},error:function(e){t.isUploading=!1,t.uploadPercent="",t.$message.error(e.message)}})},save:function(){var e=this,t=this.$loading({lock:!0,text:"保存中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});i.a.put("/user",this.form).then((function(a){try{console.log(a),t.close(),e.$message.success("修改成功"),e.closeModal(),e.complete()}catch(o){console.log(o)}})).catch((function(a){t.close(),e.$message.error(a.response.data.message)}))}},watch:{formData:function(){this.form=Object.assign({},this.form,this.formData)}}},u=d,p=(a("b65d"),a("2877")),f=Object(p["a"])(u,s,n,!1,null,"3c5e06b6",null),m=f.exports,b=a("c1df"),g={name:"robot",components:{EditDialog:m},data:function(){return{loading:!0,selectDate:[],tableData:{list:[],page_on:1,page_size:10,keyword:"",total:0,platform:1,date_start:"",date_end:""},editItem:{},editDialogFormVisible:!1}},computed:{platformConfig:function(){return this.$store.getters.platformConfig}},created:function(){var e=this;setTimeout((function(){return e.getUsers(1)}),500)},methods:{indexMethod:function(e){return(this.tableData.page_on-1)*this.tableData.page_size+e+1},edit:function(e){this.editItem=e,this.editDialogFormVisible=!0},deleteUser:function(e){var t=this;this.$confirm("您确定要删除该用户吗? 删除后不可恢复！","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning"}).then((function(){i.a.delete("/user/"+e.id).then((function(e){console.log(e.data),t.$message.success("删除成功"),t.getUsers(1)})).catch((function(e){t.$message.error(e.response.data.message)}))}))},handleSizeChange:function(e){this.tableData.page_size=e,this.getUsers()},handleCurrentChange:function(e){this.tableData.page_on=e,this.getUsers()},search:function(){2==this.selectDate.length?(this.tableData.date_start=b(this.selectDate[0]).format("YYYY-MM-DD"),this.tableData.date_end=b(this.selectDate[1]).format("YYYY-MM-DD")):(this.tableData.date_start="",this.tableData.date_end=""),this.getUsers(1)},getUsers:function(e){var t=this;e&&(this.tableData.page_on=e);var a=this.tableData,o=a.page_on,l=a.page_size,s=a.keyword,n=a.date_start,r=a.date_end,c=a.platform;i.a.post("/user/list",{page_on:o,page_size:l,keyword:s,date_start:n,date_end:r,platform:c}).then((function(e){t.loading=!1,t.tableData=e.data.data})).catch((function(e){t.loading=!1,t.$message.error(e.response.data.message)}))}}},h=g,_=(a("ae04"),Object(p["a"])(h,o,l,!1,null,"3a13145a",null));t["default"]=_.exports},"978f":function(e,t,a){},ae04:function(e,t,a){"use strict";var o=a("978f"),l=a.n(o);l.a},b65d:function(e,t,a){"use strict";var o=a("d5ea"),l=a.n(o);l.a},d5ea:function(e,t,a){}}]);
//# sourceMappingURL=chunk-56896308.d6c7d80b.js.map