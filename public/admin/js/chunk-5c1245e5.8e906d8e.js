(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c1245e5"],{"16bd":function(t,e,i){"use strict";var o=i("df1c"),a=i.n(o);a.a},5817:function(t,e,i){},"682a":function(t,e,i){"use strict";var o=i("5817"),a=i.n(o);a.a},"6fdd":function(t,e,i){"use strict";var o=i("af44"),a=i.n(o);a.a},"7a26":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"me-head"},[i("span",[i("i",{staticClass:"el-icon-reading"}),i("span",{attrs:{slot:"title"},slot:"title"},[t._v("知识库管理 ")])]),i("el-button-group",[t._l(t.total,(function(e){return[i("el-button",{key:e.id,class:{"el-button--primary":e.id+""==t.tableData.platform+""},attrs:{size:"mini"},on:{click:function(i){return t.onTogglePlatform(e.id)}}},[t._v("\n          "+t._s(e.title)+" ("+t._s(e.count)+")\n          ")])]}))],2),i("el-col",{attrs:{span:5}},[i("el-input",{attrs:{placeholder:"请输入关键词","prefix-icon":"el-icon-search",clearable:""},on:{change:t.onRefresh},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.createDialogFormVisible=!0}}},[t._v("添 加")])],1),i("el-divider"),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData.list}},[i("el-table-column",{attrs:{type:"index",index:t.indexMethod,width:"60"}}),i("el-table-column",{attrs:{prop:"title",label:"主标题"}}),i("el-table-column",{attrs:{prop:"sub_title",label:"子标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[""!=e.row.sub_title?i("div",t._l(e.row.sub_title.split("|"),(function(e,o){return i("div",{key:o,staticStyle:{"font-size":"13px"}},[t._v("\n            "+t._s(o+1)+"."+t._s(e)+"\n          ")])})),0):i("div",[t._v("-----")])]}}])}),i("el-table-column",{attrs:{prop:"content",label:"内容"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.content.split("\n"),(function(e,o){return i("div",{key:o,staticStyle:{"font-size":"13px"}},[t._v("\n              "+t._s(e)+"\n            ")])}))}}])}),i("el-table-column",{attrs:{prop:"platform",align:"center",label:"匹配平台"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",[t._v(t._s(t.$getPlatformItem(e.row.platform).title))])]}}])}),i("el-table-column",{attrs:{prop:"create_at",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t.$formatUnixDate(e.row.create_at,"YYYY/MM/DD"))+"\n      ")]}}])}),i("el-table-column",{attrs:{prop:"operating",align:"center",width:"150",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.edit(e.row)}}},[t._v("编 辑")]),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.deleteKnowledge(e.row)}}},[t._v("删 除")])]}}])})],1),i("el-row",{staticStyle:{"margin-top":"20px"},attrs:{type:"flex",justify:"space-between"}},[i("span",{staticStyle:{color:"#666","font-size":"14px"}},[t._v("共找到"+t._s(t.tableData.total)+"条数据")]),i("el-pagination",{attrs:{background:"",layout:"sizes, prev, pager, next","current-page":t.tableData.page_on,"page-sizes":[5,10,15,20],total:t.tableData.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),i("CreateDialog",{attrs:{complete:t.onRefresh,dialogFormVisible:t.createDialogFormVisible},on:{"update:dialogFormVisible":function(e){t.createDialogFormVisible=e},"update:dialog-form-visible":function(e){t.createDialogFormVisible=e}}}),i("EditDialog",{attrs:{formData:t.editItem,complete:t.onRefresh,dialogFormVisible:t.editDialogFormVisible},on:{"update:dialogFormVisible":function(e){t.editDialogFormVisible=e},"update:dialog-form-visible":function(e){t.editDialogFormVisible=e}}})],1)},a=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{width:"600px",title:"添加新的知识","show-close":!1,visible:t.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"主标题","label-width":t.formLabelWidth}},[i("el-input",{attrs:{placeholder:"请输入主标题",autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"子标题","label-width":t.formLabelWidth}},[t._l(t.dynamicTags,(function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleDel(e)}}},[t._v(t._s(e))])})),t.inputVisible?i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 新增")])],2),i("el-form-item",{attrs:{label:"内容","label-width":t.formLabelWidth}},[i("el-input",{attrs:{rows:"5",type:"textarea",autocomplete:"off"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),i("el-form-item",{attrs:{label:"匹配平台","label-width":t.formLabelWidth}},[i("el-select",{attrs:{placeholder:"请选择匹配平台"},model:{value:t.form.platform,callback:function(e){t.$set(t.form,"platform",e)},expression:"form.platform"}},t._l(t.$store.getters.platformConfig,(function(t,e){return i("el-option",{key:e,attrs:{label:t.title,value:t.id}})})),1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeModal}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)],1)},l=[],s=(i("57e7"),i("bc3a")),r=i.n(s),c={name:"mini-im-create-knowledge",data:function(){return{dynamicTags:[],inputVisible:!1,inputValue:"",form:{uid:"",platform:1,title:"",sub_title:"",content:""},formLabelWidth:"80px"}},props:{dialogFormVisible:Boolean,complete:Function},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},handleDel:function(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var t=this.inputValue;t&&this.dynamicTags.push(t),this.inputVisible=!1,this.inputValue="",console.log(this.dynamicTags.join("|"))},save:function(){var t=this,e=this.$loading({lock:!0,text:"保存中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});this.form.uid=this.$store.state.adminInfo.id,this.form.sub_title=this.dynamicTags.join("|"),r.a.post("/knowledge",this.form).then((function(i){try{console.log(i),e.close(),t.$message.success("添加成功"),t.closeModal(),t.resize(),t.complete(1)}catch(o){console.log(o)}})).catch((function(i){e.close(),t.$message.error(i.response.data.message)}))},resize:function(){this.dynamicTags=[],this.form={uid:"",platform:1,title:"",sub_title:"",content:""}}}},u=c,f=(i("6fdd"),i("2877")),d=Object(f["a"])(u,n,l,!1,null,"015f50bf",null),m=d.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{width:"600px",title:"编辑的知识","show-close":!1,visible:t.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{attrs:{model:t.form}},[i("el-form-item",{attrs:{label:"主标题","label-width":t.formLabelWidth}},[i("el-input",{attrs:{placeholder:"请输入主标题",autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"子标题","label-width":t.formLabelWidth}},[t._l(t.dynamicTags,(function(e){return i("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.handleDel(e)}}},[t._v("\n        "+t._s(e)+"\n      ")])})),t.inputVisible?i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 新增子标题")])],2),i("el-form-item",{attrs:{label:"内容","label-width":t.formLabelWidth}},[i("el-input",{attrs:{rows:"5",type:"textarea",autocomplete:"off"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),i("el-form-item",{attrs:{label:"匹配平台","label-width":t.formLabelWidth}},[i("el-select",{attrs:{placeholder:"请选择匹配平台"},model:{value:t.form.platform,callback:function(e){t.$set(t.form,"platform",e)},expression:"form.platform"}},t._l(t.platformConfig,(function(t,e){return i("el-option",{key:e,attrs:{label:t.title,value:t.id}})})),1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.closeModal}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)],1)},g=[],h=(i("28a5"),{name:"mini-im-create-knowledge",data:function(){return{dynamicTags:[],inputVisible:!1,inputValue:"",form:{uid:"",platform:1,title:"",sub_title:"",content:""},platformConfig:[],formLabelWidth:"80px"}},props:{dialogFormVisible:Boolean,complete:Function,formData:Object},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},handleDel:function(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var t=this.inputValue;t&&this.dynamicTags.push(t),this.inputVisible=!1,this.inputValue=""},save:function(){var t=this,e=this.$loading({lock:!0,text:"保存中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});this.form.uid=this.$store.state.adminInfo.id,this.form.sub_title=this.dynamicTags.join("|"),r.a.put("/knowledge",this.form).then((function(i){try{console.log(i),e.close(),t.$message.success("修改成功"),t.closeModal(),t.resize(),t.complete(1)}catch(o){console.log(o)}})).catch((function(i){e.close(),t.$message.error(i.response.data.message)}))},resize:function(){this.dynamicTags=[],this.form={uid:"",platform:1,title:"",sub_title:"",content:""}}},watch:{formData:function(){this.platformConfig=this.$store.getters.platformConfig,this.form=Object.assign({},this.form,this.formData),""!=this.formData.sub_title&&(this.dynamicTags=this.formData.sub_title.split("|"))}}}),b=h,v=(i("682a"),Object(f["a"])(b,p,g,!1,null,"7b12f7d6",null)),_=v.exports,k={name:"knowledge",components:{CreateDialog:m,EditDialog:_},data:function(){return{keyword:"",tableData:{list:[],page_on:1,page_size:10,total:0,keyword:"",platform:1},total:[],createDialogFormVisible:!1,editDialogFormVisible:!1,loading:!0,editItem:null}},computed:{platformConfig:function(){return this.$store.state.platformConfig||[]}},created:function(){var t=this;setTimeout((function(){t.getKnowledgeList(),t.getTotal()}),500)},methods:{onRefresh:function(){this.getTotal(),this.getKnowledgeList()},indexMethod:function(t){return(this.tableData.page_on-1)*this.tableData.page_size+t+1},deleteKnowledge:function(t){var e=this;this.$confirm("您确定要删除该知识库吗? 删除后不可恢复！","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,type:"warning"}).then((function(){r.a.delete("/knowledge/"+t.id).then((function(t){console.log(t.data),e.$message.success("删除成功"),e.getKnowledgeList(1)})).catch((function(t){e.$message.error(t.response.data.message)}))}))},onTogglePlatform:function(t){this.tableData.platform=parseInt(t),this.getKnowledgeList(1)},edit:function(t){this.editItem=t,this.editDialogFormVisible=!0},handleSizeChange:function(t){this.tableData.page_size=t,this.getKnowledgeList()},handleCurrentChange:function(t){this.tableData.page_on=t,this.getKnowledgeList()},getKnowledgeList:function(t){var e=this;t&&(this.tableData.page_on=t);var i=this.tableData,o=i.page_on,a=i.page_size,n=i.platform,l=this.keyword;r.a.post("/knowledge/list",{page_on:o,page_size:a,platform:n,keyword:l}).then((function(t){e.loading=!1,e.tableData=t.data.data})).catch((function(t){e.loading=!1,e.$message.error(t.response.data.message)}))},getTotal:function(){var t=this;r.a.get("/knowledge/total").then((function(e){t.total=e.data.data}))}}},w=k,y=(i("16bd"),Object(f["a"])(w,o,a,!1,null,"e6cb2868",null));e["default"]=y.exports},af44:function(t,e,i){},df1c:function(t,e,i){}}]);
//# sourceMappingURL=chunk-5c1245e5.8e906d8e.js.map