(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e29b63f"],{"0b10":function(e,t,i){},"11e9":function(e,t,i){var s=i("52a7"),n=i("4630"),a=i("6821"),o=i("6a99"),r=i("69a8"),c=i("c69a"),l=Object.getOwnPropertyDescriptor;t.f=i("9e1e")?l:function(e,t){if(e=a(e),t=o(t,!0),c)try{return l(e,t)}catch(i){}if(r(e,t))return n(!s.f.call(e,t),e[t])}},"146b":function(e,t,i){"use strict";var s=i("a818"),n=i.n(s);n.a},1826:function(e,t,i){"use strict";var s=i("fa4e"),n=i.n(s);n.a},"1c01":function(e,t,i){var s=i("5ca1");s(s.S+s.F*!i("9e1e"),"Object",{defineProperty:i("86cc").f})},"24fd":function(e,t,i){"use strict";var s=i("4e10"),n=i.n(s);n.a},"297c":function(e,t,i){"use strict";var s=i("0b10"),n=i.n(s);n.a},"29e5":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-workbench"},[i("div",{staticClass:"mini-im-session-list"},[i("div",{staticClass:"title"},[i("el-row",{attrs:{type:"flex",justify:"space-between",gutter:20}},[i("el-col",{attrs:{span:16}},[i("span",[i("i",{staticClass:"el-icon-s-custom"}),e._v("\n                 ä¼šè¯åˆ—è¡¨ ( "+e._s(e.contacts.length)+"äºº )\n               ")]),i("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer"},attrs:{title:"æ¸…ç©ºåˆ—è¡¨"},on:{click:e.clearContact}})]),i("el-col",{attrs:{span:9}},[i("el-popover",{attrs:{placement:"bottom",width:"100"}},[i("div",{staticClass:"mini-im-online-setting"},[1!=e.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return e.online(1)}}},[i("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"rgb(135, 208, 104)"}}),e._v("\n                       æˆ‘è¦ä¸Šçº¿\n                     ")]):e._e(),0!=e.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return e.online(0)}}},[i("i",{staticClass:"el-icon-switch-button",staticStyle:{color:"#ccc"}}),e._v("\n                       æˆ‘è¦ä¸‹çº¿\n                     ")]):e._e(),2!=e.adminInfo.online?i("div",{staticClass:"item",on:{click:function(){return e.online(2)}}},[i("i",{staticClass:"el-icon-remove-outline",staticStyle:{color:"#e6a23c"}}),e._v("\n                       ç¹å¿™çŠ¶æ€\n                     ")]):e._e()]),0==e.adminInfo.online?i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("i",{staticClass:"el-icon-switch-button"}),i("em",[e._v("ç¦» çº¿ ")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})]):1==e.adminInfo.online?i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",{staticStyle:{color:"rgb(135, 208, 104)"}},[i("i",{staticClass:"el-icon-circle-check"}),i("em",[e._v("åœ¨ çº¿")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])]):i("el-button",{attrs:{slot:"reference",size:"mini"},slot:"reference"},[i("span",{staticStyle:{color:"#e6a23c"}},[i("i",{staticClass:"el-icon-circle-check"}),i("em",[e._v("ç¹ å¿™")]),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])])],1)],1)],1)],1),i("div",{staticClass:"mini-im-session-content"},[i("div",{staticClass:"mini-im-flex"},[e.contacts.length<=0?i("div",{staticClass:"mini-im-no-data"},[e._v("æš‚æ— ä¼šè¯æ•°æ®")]):e._e(),e._l(e.contacts,(function(t,s){return i("ContactComponent",{key:s,class:{"mini-im-chat-item-active":e.seviceCurrentUser.from_account==t.from_account},attrs:{deleteContact:e.deleteContact,clickItem:e.selectUser,item:t}})}))],2)])]),e.$store.getters.seviceCurrentUser.id?i("div",{staticClass:"mini-im-chat-view"},[i("div",{staticClass:"mini-im-chat-view-content-header"},[i("div",{staticClass:"mini-im-header-user-box"},[i("el-avatar",{staticClass:"mini-im-avatar",attrs:{size:35}},[""!=e.seviceCurrentUser.avatar?i("img",{attrs:{src:e.seviceCurrentUser.avatar}}):[e._v("è®¿")]],2),i("div",{staticClass:"mini-im-header-user-info"},[i("div",[e._v("\n                 "+e._s(e.seviceCurrentUser.nickname)+"\n                 "),1==e.seviceCurrentUser.online?i("span",{staticStyle:{color:"rgb(135, 208, 104)"}},[e._v("â— åœ¨çº¿")]):i("span",[e._v("â— ç¦»çº¿")]),e.isInputPongIng?[i("span",{staticClass:"input-pong"},[e._v(e._s(e.inputPongIngString)+" "),i("i",{staticClass:"el-icon-edit"})])]:e._e()],2),i("span",[e._v("ç”¨æˆ·æ¥è‡³ï¼š"+e._s(e.$getPlatformItem(e.seviceCurrentUser.platform).title)+"å®¢æˆ·ç«¯ï¼Œæ‰€åœ¨åœ°ï¼š"+e._s(e.seviceCurrentUser.address||"æœªçŸ¥"))])])],1),i("el-row",{staticClass:"mini-im-buttons"},[i("el-popover",{attrs:{placement:"bottom",width:"200",trigger:"click"}},[i("div",{staticClass:"mini-im-customer-list"},[i("div",{staticClass:"mini-im-customer-title"},[e._v("è¯·é€‰æ‹©è½¬æ¥çš„å®¢æœ ("+e._s(e.filterAdmins.length)+"äººåœ¨çº¿)")]),e._l(e.filterAdmins,(function(t){return i("div",{key:t.id,staticClass:"mini-im-customer-item",on:{click:function(){return e.transferCustomer(t)}}},[i("el-avatar",{staticClass:"mini-im-avatar",attrs:{size:30}},[i("img",{attrs:{src:t.avatar}})]),i("span",[e._v(e._s(t.nickname||t.username))])],1)})),0==e.filterAdmins.length?i("div",{staticClass:"mini-im-customer-item",staticStyle:{background:"none",border:"0"}},[i("span",[e._v("å½“å‰æ²¡æœ‰å…¶ä»–å®¢æœåœ¨çº¿")])]):e._e()],2),i("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.seviceCurrentUser.is_session_end&&0!=e.adminInfo.online,expression:"seviceCurrentUser.is_session_end == 0 && adminInfo.online != 0"}],attrs:{slot:"reference",icon:"el-icon-refresh",size:"small"},on:{click:e.getAdmins},slot:"reference"},[e._v("\n               è½¬æ¥å®¢æœ\n             ")])],1),0==e.seviceCurrentUser.is_session_end&&0!=e.adminInfo.online?i("el-button",{attrs:{icon:"el-icon-close",size:"small"},on:{click:e.closeSession}},[e._v("å…³é—­ä¼šè¯")]):e._e()],1)],1),i("div",{ref:"miniImChatViewBontentBody",staticClass:"mini-im-chat-view-content-body"},[i("div",{staticClass:"mini-im-chat-view-content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.advanceText.trim(),expression:"advanceText.trim() != ''"}],staticClass:"advance"},[i("div",[e._v("æ­£åœ¨è¾“å…¥ï¼š")]),i("span",[e._v("\n                 "+e._s(e.advanceText)+"\n                 "),e.isInputPongIng?[i("span",{staticClass:"input-pong"},[e._v(e._s(e.inputPongIngString.replace("å¯¹æ–¹æ­£åœ¨è¾“å…¥",""))+" "),i("i",{staticClass:"el-icon-edit"})])]:e._e()],2)]),i("div",{ref:"chatBody",staticClass:"mini-im-chat-body",attrs:{id:"chatBody"}},[i("ChatWindowComponent",{attrs:{onLoadMor:e.onLoadMorMessage,isMessageEnd:e.isMessageEnd,onCancelMessage:e.onCancelMessage,messages:e.messageRecord.list,loading:e.getMessageRecordLoading}})],1),i("div",{staticClass:"mini-im-chat-input"},[i("div",{staticClass:"mini-im-chat-input-bar"},[i("el-row",[i("EmojiComponent",{attrs:{clickEmoji:e.clickEmoji}}),i("span",{staticClass:"mini-im-button",attrs:{title:"é€‰æ‹©å›¾ç‰‡"}},[e._v("\n                       ğŸŒ\n                       "),i("input",{attrs:{onClick:"this.value = null",type:"file",accept:"image/*"},on:{change:e.sendPhotoMessageEvent}})])],1),i("el-row",[i("el-popover",{attrs:{placement:"top-start",width:"350",trigger:"hover"}},[i("div",{staticClass:"mini-im-shortcut"},[i("div",{staticClass:"mini-im-shortcut-head"},[i("span",[i("i",{staticClass:"el-icon-tickets"}),e._v("å¿«æ·è¯­å›å¤åˆ—è¡¨")]),i("div",[i("button",{attrs:{title:"æ·»åŠ "},on:{click:function(t){e.createShortcutDialogFormVisible=!0}}},[i("i",{staticClass:"el-icon-plus"})]),i("button",{attrs:{title:"ç¼–è¾‘"},on:{click:function(t){e.shortcutEditVisible=!e.shortcutEditVisible}}},[i("i",{staticClass:"el-icon-edit"})])])]),i("div",{staticClass:"mini-im-shortcut-body"},[i("el-input",{staticStyle:{"margin-bottom":"10px"},attrs:{clearable:"",type:"text",placeholder:"è¯·è¾“å…¥å…³é”®è¯",autocomplete:"off"},model:{value:e.shortcutKey,callback:function(t){e.shortcutKey=t},expression:"shortcutKey"}}),0==e.filterShortcuts.length?i("div",{staticClass:"mini-im-shortcut-item",staticStyle:{background:"none"}},[i("span",{staticStyle:{"text-align":"center","margin-top":"20px"}},[e._v("æš‚æ— å¿«æ·è¯­")])]):e._e(),e._l(e.filterShortcuts,(function(t){return i("div",{key:t.id,staticClass:"mini-im-shortcut-item",attrs:{title:t.content}},[i("span",{domProps:{innerHTML:e._s(t.title.replace(/\n/g,"<br>"))},on:{"!click":function(i){return function(){return e.checkShortcut(t.content)}()}}}),i("button",{directives:[{name:"show",rawName:"v-show",value:e.shortcutEditVisible,expression:"shortcutEditVisible"}],attrs:{title:"ä¿®æ”¹"},on:{"!click":function(i){return function(){return e.editShortcut(t)}()}}},[i("i",{staticClass:"el-icon-edit"})]),i("button",{directives:[{name:"show",rawName:"v-show",value:e.shortcutEditVisible,expression:"shortcutEditVisible"}],attrs:{title:"åˆ é™¤"},on:{"!click":function(i){return function(){return e.deleteShortcut(t)}()}}},[i("i",{staticClass:"el-icon-delete"})])])}))],2)]),i("button",{staticClass:"mini-im-button",attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"el-icon-tickets",staticStyle:{"font-size":"15px"}}),i("span",{staticStyle:{"font-size":"14px"}},[e._v(" å¿«æ·è¯­")])])])],1)],1),i("div",{staticClass:"mini-im-chat-input-edit",on:{keyup:[function(t){return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.keyUpEvent(t)},function(t){return!t.type.indexOf("key")&&13!==t.keyCode&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.shiftKey?e.enterShift(t):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.sendMessage(t)}]}},[i("el-input",{ref:"chatValueDom",staticClass:"mini-im-chat-text-input",attrs:{type:"textarea",rows:"3",resize:"none",autosize:!1,disabled:1==e.seviceCurrentUser.is_session_end||0==e.adminInfo.online,maxlength:"200","show-word-limit":"",placeholder:1==e.seviceCurrentUser.is_session_end?"å½“å‰ä¼šè¯å·²ç»“æŸ":"è¯·è¾“å…¥å†…å®¹"},model:{value:e.chatValue,callback:function(t){e.chatValue=t},expression:"chatValue"}})],1)])]),i("div",{staticClass:"mini-im-chat-view-user"},[i("el-tabs",{attrs:{type:"border-card"}},[i("el-tab-pane",{attrs:{label:"ç”¨æˆ·ä¿¡æ¯"}},[i("UserInfoComponent")],1)],1)],1)])]):i("div",{staticClass:"mini-im-chat-view no-window"},[e._m(0),i("span",[e._v("å½“å‰æ— å¯¹è¯")]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.chatWindowLoading,expression:"chatWindowLoading"}],staticClass:"mini-im-right-window-loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[e._v("æ•°æ®åŠ è½½ä¸­...")])])]),i("CreateShortcutComponent",{attrs:{complete:e.getShortcuts,dialogFormVisible:e.createShortcutDialogFormVisible},on:{"update:dialogFormVisible":function(t){e.createShortcutDialogFormVisible=t},"update:dialog-form-visible":function(t){e.createShortcutDialogFormVisible=t}}}),i("EditShortcutComponent",{attrs:{formData:e.editShortcutItem,complete:e.getShortcuts,dialogFormVisible:e.editShortcutDialogFormVisible},on:{"update:dialogFormVisible":function(t){e.editShortcutDialogFormVisible=t},"update:dialog-form-visible":function(t){e.editShortcutDialogFormVisible=t}}})],1)},n=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("i",{staticClass:"el-icon-service"})])}],a=(i("1c01"),i("58b2"),i("8e6e"),i("f3e2"),i("ac6a"),i("456d"),i("c5f6"),i("4917"),i("a481"),i("6d67"),i("57e7"),i("d25f"),i("4f37"),i("85f2")),o=i.n(a);function r(e,t,i){return t in e?o()(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"}},[i("div",{staticClass:"emoji-box"},e._l(e.emojis,(function(t,s){return i("span",{key:s,on:{click:function(i){return e.clickEmoji(t)}}},[e._v(e._s(t))])})),0),i("button",{staticClass:"mini-im-button",staticStyle:{"font-size":"20px"},attrs:{slot:"reference",title:"é€‰æ‹©è¡¨æƒ…"},slot:"reference"},[e._v("ğŸ˜Š")])])},l=[],u=i("eef3"),m={name:"mini-im-emoji",data:function(){return{emojis:u.emojiData}},props:{clickEmoji:Function}},d=m,f=(i("1826"),i("2877")),h=Object(f["a"])(d,c,l,!1,null,"3d019866",null),g=h.exports,v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-chat-item"},[i("span",{staticClass:"delete_contact",attrs:{title:"åˆ é™¤è¯¥è®°å½•"},on:{"!click":function(t){return e.deleteContact(e.item)}}},[i("i",{staticClass:"el-icon-close"})]),i("el-avatar",{staticClass:"mini-im-avatar",on:{click:function(t){return e.clickItem(e.item)}}},[""!=e.item.avatar?i("img",{attrs:{src:e.item.avatar}}):[e._v("è®¿")]],2),i("div",{staticClass:"mini-im-message-box",on:{click:function(t){return e.clickItem(e.item)}}},[i("div",{staticClass:"mini-im-user-date"},[i("div",{staticClass:"mini-im-nickname"},[i("span",{staticClass:"mini-im-online-status",class:{success:1==e.item.online}},[e._v("â—")]),e._v(" "+e._s(e.item.nickname)+"\n          ")]),i("div",{staticClass:"mini-im-date"},[e._v("\n              "+e._s(e.$formatFromNowDate(e.item.contact_create_at))+"\n          ")])]),i("div",{staticClass:"mini-im-message-badge"},["text"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v(e._s(e.item.last_message))]):e._e(),"photo"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("æ”¶åˆ°å›¾ç‰‡æ–‡ä»¶")]):e._e(),"video"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("æ”¶åˆ°è§†é¢‘æ–‡ä»¶")]):e._e(),"end"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("ä¼šè¯ç»“æŸ")]):e._e(),"cancel"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("å¯¹æ–¹æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯")]):e._e(),"timeout"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("ä¼šè¯è¶…æ—¶ï¼Œç»“æŸå¯¹è¯")]):e._e(),"transfer"==e.item.last_message_type||"handshake"==e.item.last_message_type?i("div",{staticClass:"mini-im-message"},[e._v("å®¢æœè½¬æ¥...")]):e._e(),e.item.read>0?i("div",{staticClass:"mini-im-badge"},[e._v(e._s(e.item.read))]):e._e()])])],1)},p=[],_={name:"mini-im-contact",data:function(){return{}},props:{item:Object,clickItem:Function,deleteContact:Function}},b=_,C=(i("297c"),Object(f["a"])(b,v,p,!1,null,"595d9a46",null)),y=C.exports,w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-username-component-box"},[i("div",{staticClass:"mini-im-username-component"},[i("button",{attrs:{title:"ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯"},on:{click:function(t){e.isUserReadonly=!e.isUserReadonly}}},[i("i",{staticClass:"el-icon-edit"})])]),i("el-form",{ref:"form",class:{"form-item-readonly":e.isUserReadonly},attrs:{"label-width":"80px"}},[i("el-form-item",{staticClass:"form-item",attrs:{label:"ç”¨æˆ·æ˜µç§°"}},[i("el-input",{attrs:{placeholder:"æ¸¸å®¢",readonly:e.isUserReadonly,type:"text"},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"æ‰€åœ¨åœ°åŒº"}},[i("el-input",{attrs:{readonly:e.isUserReadonly,placeholder:"æ— ",type:"text"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"è”ç³»æ–¹å¼"}},[i("el-input",{attrs:{readonly:e.isUserReadonly,placeholder:"æ— è”ç³»æ–¹å¼",type:"text"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{staticClass:"form-item no-border",attrs:{label:"æ‰€åœ¨å¹³å°"}},[i("el-input",{attrs:{readonly:"",value:e.$getPlatformItem(e.user.platform).title,resize:"none",type:"text"}})],1),i("el-form-item",{staticClass:"form-item no-border",attrs:{label:"åˆ›å»ºæ—¶é—´"}},[i("el-input",{attrs:{readonly:"",value:e.$formatUnixDate(e.user.create_at,"YYYY/MM/DD"),resize:"none",type:"text"}})],1),i("el-form-item",{staticClass:"form-item",attrs:{label:"å¤‡æ³¨ä¿¡æ¯"}},[i("el-input",{attrs:{rows:"4",readonly:e.isUserReadonly,placeholder:"æ— å¤‡æ³¨",resize:"none",type:"textarea"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e.isUserReadonly?e._e():i("el-row",{attrs:{type:"flex",justify:"center"}},[i("el-button",{on:{click:function(t){e.isUserReadonly=!0}}},[e._v("å–æ¶ˆ")]),i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("ä¿å­˜")])],1),e.isUserReadonly?e._e():i("div",{staticStyle:{"text-align":"center","font-size":"12px",color:"#666","margin-top":"15px"}},[e._v("å½“å‰ä¸ºç¼–è¾‘æ¨¡å¼")])],1)],1)},S=[],k=i("bc3a"),x=i.n(k),$={name:"mini-im-user-info",data:function(){return{form:{id:"",nickname:"",address:"",phone:"",remarks:""},isUserReadonly:!0}},computed:{user:function(){return this.$store.getters.seviceCurrentUser||{}}},methods:{save:function(){var e=this;x.a.put("/user",this.form).then((function(){e.isUserReadonly=!0})).catch((function(t){e.$message.error(t.response.data.message)}))}},watch:{user:function(e){e.id!=this.form.id&&(this.isUserReadonly=!0),(this.isUserReadonly||e.id!=this.form.id)&&(this.form=this.user)}}},I=$,M=(i("2b0b"),Object(f["a"])(I,w,S,!1,null,null,null)),U=M.exports,T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{width:"600px",title:"æ·»åŠ å¿«æ·è¯­","show-close":!1,visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{attrs:{model:e.form}},[i("el-form-item",{attrs:{label:"æ ‡é¢˜","label-width":e.formLabelWidth}},[i("el-input",{attrs:{maxlength:"50","show-word-limit":"",type:"text",placeholder:"è¯·è¾“å…¥æ ‡é¢˜",autocomplete:"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"å†…å®¹","label-width":e.formLabelWidth}},[i("el-input",{attrs:{rows:"8",resize:"none",autosize:!1,maxlength:"200","show-word-limit":"",type:"textarea",placeholder:"è¯·è¾“å…¥å¿«æ·è¯­",autocomplete:"off"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeModal}},[e._v("å– æ¶ˆ")]),i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("ä¿ å­˜")])],1)],1)},E=[],O={name:"mini-im-create-shortcuts",data:function(){return{form:{content:"",title:""},formLabelWidth:"40px"}},props:{dialogFormVisible:Boolean,complete:Function},mounted:function(){},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},save:function(){var e=this;if(""!=this.form.title.trim()&&""!=this.form.content.trim()){var t=this.$loading({lock:!0,text:"ä¿å­˜ä¸­...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});x.a.post("/shortcut",this.form).then((function(i){try{console.log(i),t.close(),e.$message.success("æ·»åŠ æˆåŠŸ"),e.closeModal(),e.complete(),e.form={content:"",title:""}}catch(s){console.log(s)}})).catch((function(i){t.close(),e.$message.error(i.response.data.message)}))}}}},R=O,P=Object(f["a"])(R,T,E,!1,null,"ae51b748",null),L=P.exports,V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{width:"600px",title:"ç¼–è¾‘å¿«æ·è¯­","show-close":!1,visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{attrs:{model:e.form}},[i("el-form-item",{attrs:{label:"æ ‡é¢˜","label-width":e.formLabelWidth}},[i("el-input",{attrs:{maxlength:"50","show-word-limit":"",type:"text",placeholder:"è¯·è¾“å…¥æ ‡é¢˜",autocomplete:"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"å†…å®¹","label-width":e.formLabelWidth}},[i("el-input",{attrs:{rows:"8",resize:"none",autosize:!1,maxlength:"200","show-word-limit":"",type:"textarea",placeholder:"è¯·è¾“å…¥å¿«æ·è¯­",autocomplete:"off"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeModal}},[e._v("å– æ¶ˆ")]),i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("ä¿ å­˜")])],1)],1)},N=[],F={name:"mini-im-edit-shortcuts",data:function(){return{form:{content:"",title:""},formLabelWidth:"40px"}},props:{dialogFormVisible:Boolean,complete:Function,formData:Object},methods:{closeModal:function(){this.$emit("update:dialogFormVisible",!1)},save:function(){var e=this;if(""!=this.form.title.trim()&&""!=this.form.content.trim()){var t=this.$loading({lock:!0,text:"ä¿å­˜ä¸­...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});x.a.put("/shortcut",this.form).then((function(i){try{console.log(i),t.close(),e.$message.success("æ·»åŠ æˆåŠŸ"),e.closeModal(),e.complete()}catch(s){console.log(s)}})).catch((function(i){t.close(),e.$message.error(i.response.data.message)}))}}},watch:{formData:function(){this.form=Object.assign({},this.form,this.formData)}}},z=F,j=Object(f["a"])(z,V,N,!1,null,"3714045a",null),D=j.exports,A=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mini-im-chat-list"},[i("div",{staticClass:"mini-im-chat-message-box"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[e._v("æ¶ˆæ¯åŠ è½½ä¸­...")])]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isMessageEnd,expression:"isMessageEnd"}],attrs:{type:"text",disabled:"",icon:"el-icon-refresh-right"}},[e._v("æ— æ›´å¤šèŠå¤©è®°å½•...")]),e.isMessageEnd||e.loading?e._e():i("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.onLoadMor}},[e._v("ç‚¹å‡»åŠ è½½æ›´å¤šèŠå¤©è®°å½•")])],1),i("div",{staticClass:"mini-im-chat-message-box"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.messages.length<=0&&!e.loading,expression:"messages.length <= 0 && !loading"}],staticClass:"loading"},[i("i",{staticClass:"el-icon-time"}),i("span",[e._v("æš‚æ— èŠå¤©è®°å½•...")])])]),e._l(e.messages,(function(t,s){return i("div",{key:s,staticClass:"mini-im-chat-message-box",class:{self:t.from_account!=e.seviceCurrentUser.id}},["text"==t.biz_type||"photo"==t.biz_type||"knowledge"==t.biz_type||"knowledge_list"==t.biz_type?[i("div",{staticClass:"user-date"},[t.from_account==e.adminInfo.id?i("span",[e._v("\n              "+e._s(e.adminInfo.nickname||e.adminInfo.username)+"\n            ")]):t.from_account==e.seviceCurrentUser.from_account?i("span",[e._v("\n              "+e._s(e.seviceCurrentUser.nickname)+"\n            ")]):i("span",[i("span",{staticStyle:{"font-size":"12px",color:"#666"}},[e._v("(æœºå™¨äºº)")]),e._v(e._s(e.$robotNickname(t.from_account))+"\n            ")]),i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))])])]:e._e(),"text"==t.biz_type?[i("div",{staticClass:"text"},[t.from_account==e.adminInfo.id&&t.isShowCancel?i("div",{staticClass:"cancel-btn",attrs:{title:"æ’¤å›æœ¬æ¡æ¶ˆæ¯"},on:{click:function(){return e.onCancelMessage(t.key)}}},[e._v("\n              æ’¤å›\n            ")]):e._e(),i("span",{domProps:{innerHTML:e._s(t.payload.replace(/\n/gi,"<br />"))}})])]:e._e(),"photo"==t.biz_type?[i("div",{staticClass:"photo"},[t.percent&&100!=t.percent?i("div",{staticClass:"loading"},[i("i",{staticClass:"el-icon-loading"}),i("span",[e._v(e._s(t.percent)+"%")])]):e._e(),t.from_account==e.adminInfo.id&&t.isShowCancel?i("div",{staticClass:"cancel-btn",attrs:{title:"æ’¤å›æœ¬æ¡æ¶ˆæ¯"},on:{click:function(){return e.onCancelMessage(t.key)}}},[e._v("\n              æ’¤å›\n            ")]):e._e(),i("div",{staticClass:"img-content"},[i("img",{attrs:{src:t.payload,preview:"1"}})])])]:e._e(),"transfer"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),i("span",[e._v(e._s(t.payload))])])]:e._e(),"end"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),t.to_account!=e.adminInfo.id?i("span",[e._v("ä½ ç»“æŸäº†ä¼šè¯")]):i("span",[e._v("å¯¹æ–¹ç»“æŸäº†ä¼šè¯")]),i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))])])]:e._e(),"timeout"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),i("span",[e._v("ç”¨æˆ·é•¿æ—¶é—´æ— åº”ç­”ï¼Œä¼šè¯ç»“æŸ")])])]:e._e(),"cancel"==t.biz_type?[i("div",{staticClass:"system"},[i("em",[e._v(e._s(e.$formatFromNowDate(t.timestamp)))]),t.from_account==e.adminInfo.id?i("span",[e._v("æ‚¨æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯")]):i("span",[e._v("å¯¹æ–¹æ’¤å›äº†ä¸€æ¡æ¶ˆæ¯")])])]:e._e(),"knowledge"==t.biz_type?[i("div",{staticClass:"knowledge"},[i("div",{staticClass:"content"},[i("div",{staticClass:"title"},[e._v("ä»¥ä¸‹æ˜¯å¦æ˜¯æ‚¨å…³å¿ƒçš„ç›¸å…³é—®é¢˜å‘¢ï¼Ÿ")]),e._l(JSON.parse(t.payload),(function(t,s){return i("div",{key:s,staticClass:"item"},[e._v("\n                "+e._s(s+1)+"."+e._s(t.title)+"\n              ")])}))],2)])]:e._e()],2)}))],2)},B=[],K={name:"mini-im-contact",data:function(){return{}},computed:{seviceCurrentUser:function(){return this.$store.getters.seviceCurrentUser||{}},adminInfo:function(){return this.$store.getters.adminInfo||{}}},props:{loading:Boolean,onCancelMessage:Function,messages:Array,onLoadMor:Function,isMessageEnd:Boolean},watch:{messages:function(){var e=this;setTimeout((function(){e.$previewRefresh()}),1e3)}}},G=K,W=(i("24fd"),Object(f["a"])(G,A,B,!1,null,"019193ce",null)),H=W.exports,J=i("fb21"),Y=i("b730"),q=i.n(Y),X=i("2f62");function Q(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Z(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Q(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ee={name:"workbench",components:{EmojiComponent:g,ContactComponent:y,UserInfoComponent:U,ChatWindowComponent:H,CreateShortcutComponent:L,EditShortcutComponent:D},data:function(){return{chatValue:"",advanceText:"",admins:[],shortcuts:[],shortcutKey:"",createShortcutDialogFormVisible:!1,editShortcutDialogFormVisible:!1,editShortcutItem:null,shortcutEditVisible:!1,getMessageRecordLoading:!0,chatWindowLoading:!1,currentSessionIsEnd:!1,getMessageRecordPageSize:20,isInputPongIng:!1,isSendPong:!1,inputPongIngString:"å¯¹æ–¹æ­£åœ¨è¾“å…¥...",isPush:!1,isMessageEnd:!1}},computed:Z({filterShortcuts:function(){var e=this.shortcutKey.trim();return""!=e?this.shortcuts.filter((function(t){return-1!=t.title.indexOf(e)})):this.shortcuts},filterAdmins:function(){var e=this;return this.admins.filter((function(t){return t.id!=e.adminInfo.id&&(1==t.online||2==t.online)}))}},Object(X["b"])(["contacts","adminInfo","seviceCurrentUser","messageRecord"])),mounted:function(){var e,t=this;document.ondblclick=function(){t.shortcutEditVisible=!1},this.init(),document.addEventListener("mousemove",(function(){t.$refs.miniImChatViewBontentBody&&(t.$refs.miniImChatViewBontentBody.style.height=document.body.clientHeight-155+"px"),t.isPush=!1,e&&clearTimeout(e),e=setTimeout((function(){t.isPush=!0}),3e4)})),document.addEventListener("paste",this.inputPaste,!1)},beforeDestroy:function(){this.changeCurrentUser()},methods:{init:function(){var e=this;this.adminInfo?(this.getShortcuts(),this.chatWindowLoading=!0,setTimeout((function(){e.chatWindowLoading=!1}),1500),setTimeout((function(){var t,i=e.$store.getters.seviceCurrentUser.id||e.$route.query.uid;(e.changeCurrentUser(i||0),i)&&(e.contacts.map((function(e){e.from_account==i&&(t=e)})),history.replaceState(null,null,location.href.replace(/uid=\d+/i,"uid="+i)),e.$store.commit("onChangeSeviceCurrentUser",t),t&&e.selectUser(t),e.getMessageRecord(),e.scrollIntoBottom())}),1e3),this.$mimcInstance.addEventListener("statusChange",(function(t){1==e.adminInfo.online?e.$message.success("æ‚¨å½“å‰çŠ¶æ€ä¸ºåœ¨çº¿"):2==e.adminInfo.online&&e.$message.warning("æ‚¨å½“å‰çŠ¶æ€ä¸ºç¹å¿™"),t||e.$message.info("ç™»å½•å¼‚å¸¸ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ï¼")})),this.$mimcInstance.addEventListener("receiveP2PMsg",this.receiveP2PMsg),this.$mimcInstance.addEventListener("disconnect",(function(){console.log("é“¾æ¥æ–­å¼€ï¼");var t=e.adminInfo;t.online=0,e.$store.commit("onChangeAdminInfo",t)}))):setTimeout((function(){return e.init()}),100)},enterShift:function(e){"Enter"!=e.code&&(this.chatValue=this.chatValue+"\n")},scrollIntoBottom:function(){try{setTimeout((function(){var e=document.getElementById("chatBody");if(e){var t=e.clientHeight,i=e.scrollHeight;e.scrollTop=i-t}}),50)}catch(e){console.log(e)}},deleteContact:function(e){var t=this;e&&e.cid&&x.a.delete("/contact/"+e.cid).then((function(){t.$message.success("åˆ é™¤æˆåŠŸ"),t.$store.dispatch("ON_GET_CONTACTS"),t.seviceCurrentUser.id==e.id&&(t.changeCurrentUser(),t.$store.commit("onChangeSeviceCurrentUser",null))})).catch((function(e){t.$message.error(e.response.data.message)}))},clearContact:function(){var e=this;this.$confirm("æ‚¨ç¡®å®šè¦æ¸…ç©ºåˆ—è¡¨å—? ","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){x.a.delete("/contact/clear").then((function(){e.$message.success("æ¸…ç©ºæˆåŠŸ"),e.$store.dispatch("ON_GET_CONTACTS"),e.changeCurrentUser(),e.$store.commit("onChangeSeviceCurrentUser",null)})).catch((function(t){e.$message.error(t.response.data.message)}))}))},clickEmoji:function(e){0!=this.adminInfo.online?1!=this.seviceCurrentUser.is_session_end?(this.chatValue=this.chatValue+e,this.$refs.chatValueDom.focus()):this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼"):this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},checkShortcut:function(e){0!=this.adminInfo.online?1!=this.seviceCurrentUser.is_session_end?(this.shortcutKey="",this.chatValue=e,this.$refs.chatValueDom.focus()):this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼"):this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},getShortcuts:function(){var e=this;x.a.get("/shortcut/list").then((function(t){e.shortcuts=t.data.data})).catch((function(t){e.$message.error(t.response.data.message)}))},editShortcut:function(e){this.editShortcutItem=e,this.editShortcutDialogFormVisible=!0},getAdmins:function(){var e=this;x.a.post("/admin/list",{page_on:1,page_size:1e4,online:3}).then((function(t){e.loading=!1,e.admins=t.data.data.list})).catch((function(t){e.$message.error(t.response.data.message)}))},deleteShortcut:function(e){var t=this;this.$confirm("æ‚¨ç¡®å®šè¦åˆ é™¤è¯¥å¿«æ·è¯­å—?","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){x.a.delete("/shortcut/"+e.id).then((function(){t.$message.success("åˆ é™¤æˆåŠŸ"),t.getShortcuts()})).catch((function(e){t.$message.error(e.response.data.message)}))}))},onCancelMessage:function(e){var t=this.$mimcInstance.sendMessage("cancel",this.seviceCurrentUser.from_account,e);this.messageRecord.list.push(t),this.removeMessage(this.adminInfo.id,e),this.qiniuObservable&&this.qiniuObservable.unsubscribe()},transferCustomer:function(e){var t=this;this.$confirm("æ‚¨ç¡®å®šå°†è¯¥å®¢æˆ·è½¬æ¥ç»™ "+(e.nickname||e.username)+" å—?","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"è½¬æ¥",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){x.a.post("/message/transfer",{to_account:e.id,user_account:t.seviceCurrentUser.from_account}).then((function(){var e=t.seviceCurrentUser;e.is_session_end=1,t.$store.commit("onChangeSeviceCurrentUser",e)})).catch((function(e){t.$message.error(e.response.data.message)}))}))},closeSession:function(){var e=this;this.$confirm("æ‚¨ç¡®å®šå…³é—­å½“å‰å›è¯å—?å¼ºåˆ¶å…³é—­å¯èƒ½ä¼šè¢«å®¢æˆ·æŠ•è¯‰ï¼","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"å…³é—­",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){var t=e.$mimcInstance.sendMessage("end",e.seviceCurrentUser.from_account,"");e.messageRecord.list.push(t);var i=e.seviceCurrentUser;i.is_session_end=1,e.$store.commit("onChangeSeviceCurrentUser",i)}))},changeUserOnlineStatus:function(e){var t=this;x.a.put("/admin/online/"+e).then((function(){t.$store.dispatch("ON_GET_ME"),0==e&&t.$message.info("å½“å‰çŠ¶æ€ä¸ºç¦»çº¿")})).catch((function(e){t.$message.error(e.response.data.message)}))},online:function(e){var t=this;t.adminInfo.online!=e&&t.$confirm("æ‚¨ç¡®å®š"+(0==e?"ä¸‹çº¿":1==e?"ä¸Šçº¿":"è®¾ç½®ç¹å¿™")+"å—ï¼","æ¸©é¦¨æç¤ºï¼",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",center:!0,type:"warning"}).then((function(){0==e?(t.$mimcInstance.logout(),t.changeUserOnlineStatus(e),t.$store.commit("onChangeMimcUser",null)):t.$mimcInstance.login((function(){t.changeUserOnlineStatus(e),t.$store.dispatch("ON_RUN_LAST_ACTiIVITY"),t.$store.dispatch("ON_GET_CONTACTS"),t.$store.commit("onChangeMimcUser",t.$mimcInstance.user)}))}))},receiveP2PMsg:function(e){var t=this,i=parseInt(((new Date).getTime()+"").substr(0,10));if(e.timestamp=parseInt((e.timestamp+"").substr(0,10)),"text"==e.biz_type&&e.from_account==this.seviceCurrentUser.from_account&&(this.advanceText=""),"contacts"!=e.biz_type){if(!(i-e.timestamp>=60))if("cancel"==e.biz_type&&this.removeMessage(e.from_account,e.payload),"handshake"!=e.biz_type){if("pong"==e.biz_type&&e.from_account==this.seviceCurrentUser.from_account)return this.advanceText=e.payload,void this.inputPongIng();if("contacts"!=e.biz_type&&"pong"!=e.biz_type&&"welcome"!=e.biz_type&&"cancel"!=e.biz_type&&"handshake"!=e.biz_type&&"end"!=e.biz_type&&"timeout"!=e.biz_type&&this.isPush&&q.a.Permission.has()&&q.a.create("æ”¶åˆ°ä¸€æ¡æ–°æ¶ˆæ¯",{body:e.payload,icon:this.$store.state.pushIcon,timeout:5e3,onClick:function(){t.$router.push({path:"/workbench?uid="+e.from_account}),window.focus(),setTimeout((function(){return t.getMessageRecord()}),1e3)}}),e.from_account==this.seviceCurrentUser.from_account){if("end"==e.biz_type){var s=this.seviceCurrentUser;s.is_session_end=1,this.$store.commit("onChangeSeviceCurrentUser",s),this.advanceText=""}this.messageRecord.list.push(e);var n=JSON.stringify(this.messageRecord);this.$store.commit("onChangeMessageRecord",JSON.parse(n)),this.scrollIntoBottom(),this.$previewRefresh()}}else setTimeout((function(){t.$mimcInstance.sendMessage("text",e.from_account,t.adminInfo.auto_reply),void 0!=t.seviceCurrentUser&&null!=t.seviceCurrentUser&&setTimeout((function(){return t.getMessageRecord()}),1e3)}),500)}else{var a=JSON.parse(e.payload);this.$store.commit("onChangeContacts",a)}},changeCurrentUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;"{}"!=JSON.stringify(this.adminInfo)&&x.a.get("/admin/current/user/"+e)},sendMessage:function(){if(0!=this.adminInfo.online){if(1!=this.seviceCurrentUser.is_session_end)if(1!=this.seviceCurrentUser.is_session_end){var e=this.chatValue.trim();if(""!=e){this.shortcutEditVisible=!1,this.scrollIntoBottom();var t=this.$mimcInstance.sendMessage("text",this.seviceCurrentUser.from_account,this.chatValue.trim("\n"));t.isShowCancel=!0,setTimeout((function(){return t.isShowCancel=!1}),1e4),this.messageRecord.list.push(t),this.chatValue=""}else this.chatValue=""}else this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼")}else this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},sendPhotoMessageEvent:function(e){var t=e.target,i=t.files[0];this.sendPhotoMessage(i)},sendPhotoMessage:function(e){if(0!=this.adminInfo.online)if(1!=this.seviceCurrentUser.is_session_end){var t=new FileReader;t.readAsDataURL(e);var i,s=this;t.onload=function(){i=s.$mimcInstance.createLocalMessage("photo",s.seviceCurrentUser.from_account,this.result),i["percent"]=0,i.isShowCancel=!0,s.messageRecord.list.push(i),setTimeout((function(){return i.isShowCancel=!1}),1e4),s.$previewRefresh(),s.scrollIntoBottom(),Object(J["a"])({file:e,progress:function(e){i.percent=e},success:function(e){i.percent=100;var t=s.$store.getters.uploadToken.host+"/"+e;s.$mimcInstance.sendMessage("photo",s.seviceCurrentUser.from_account,t)},error:function(e){i.percent=0,s.$message.error(e.message)}})}}else this.$message.info("å½“å‰ä¼šè¯å·²ç»“æŸï¼");else this.$message.info("æ‚¨å½“å‰ä¸ºç¦»çº¿çŠ¶æ€ï¼")},selectUser:function(e){var t=location.href,i=t.indexOf("#");t=t.substr(0,-1!=i?i:t.length),history.replaceState(null,null,t+"#/workbench?uid="+e.from_account),this.isMessageEnd=!1,this.seviceCurrentUser.from_account!=e.from_account&&(this.messageRecord.list=[],this.$store.commit("onChangeSeviceCurrentUser",e),this.changeCurrentUser(e.from_account)),this.timestamp=void 0,this.getMessageRecord(),this.advanceText=""},getMessageRecord:function(e){var t=this;this.getMessageRecordLoading=!0,void 0==e&&(e=0);var i=parseInt(this.seviceCurrentUser.from_account);i&&x.a.post("/message/list",{timestamp:e,page_size:this.getMessageRecordPageSize,account:i}).then((function(i){t.getMessageRecordLoading=!1,i.data.data.list.length<t.getMessageRecordPageSize&&(t.isMessageEnd=!0),0==t.messageRecord.list.length||0==e?(t.$store.commit("onChangeMessageRecord",i.data.data),t.scrollIntoBottom()):(i.data.data.list=i.data.data.list.concat(t.messageRecord.list),t.$store.commit("onChangeMessageRecord",i.data.data)),setTimeout((function(){return t.$previewRefresh()}),1e3),t.$store.dispatch("ON_GET_CONTACTS")})).catch((function(){t.getMessageRecordLoading=!1}))},onLoadMorMessage:function(){this.getMessageRecordLoading||(this.messageRecord.list.length>=this.messageRecord.total||this.messageRecord.total<=this.getMessageRecordPageSize?this.isMessageEnd=!0:(this.getMessageRecord(this.messageRecord.list[0].timestamp),setTimeout((function(){var e=document.getElementById("chatBody");e.scrollTop=500}),50)))},inputPongIng:function(){var e=this;this.isInputPongIng||(this.isInputPongIng=!0,setTimeout((function(){e.inputPongIngString="å¯¹æ–¹æ­£åœ¨è¾“å…¥."}),500),setTimeout((function(){e.inputPongIngString="å¯¹æ–¹æ­£åœ¨è¾“å…¥.."}),1500),setTimeout((function(){e.inputPongIngString="å¯¹æ–¹æ­£åœ¨è¾“å…¥...",e.isInputPongIng=!1}),3e3))},keyUpEvent:function(){var e=this;this.isSendPong||(this.isSendPong=!0,setTimeout((function(){return e.isSendPong=!1}),500),this.$mimcInstance.sendMessage("pong",this.seviceCurrentUser.from_account,""))},removeMessage:function(e,t){for(var i=[],s=this.messageRecord.list,n=0;n<s.length;n++)s[n].key==t&&s[n].from_account==e||i.push(s[n]);this.messageRecord.list=i,this.$store.commit("onChangeMessageRecord",this.messageRecord)},inputPaste:function(e){if(this.seviceCurrentUser.id&&1!=this.seviceCurrentUser.is_session_end){var t=this,i=e.clipboardData,s=window.navigator.userAgent;if(e.clipboardData&&e.clipboardData.items&&!(i.items&&2===i.items.length&&"string"===i.items[0].kind&&"file"===i.items[1].kind&&i.types&&2===i.types.length&&"text/plain"===i.types[0]&&"Files"===i.types[1]&&s.match(/Macintosh/i)&&Number(s.match(/Chrome\/(\d{2})/i)[1])<49))for(var n=0;n<i.items.length;n++){var a=i.items[n];if("file"==a.kind){var o=a.getAsFile();if(0===o.size)return;var r=new FileReader;r.readAsDataURL(o),r.onload=function(){var e=this.result;t.$alert('<img preview="1" style="width:100%;max-height: 500px;" src="'+e+'" />',"æ£€æµ‹åˆ°å›¾ç‰‡æ˜¯å¦è¦å‘é€ï¼Ÿ",{dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"å‘é€"}).then((function(){t.sendPhotoMessage(o)})),t.$previewRefresh()}}}}}},watch:{messageRecord:function(){this.$previewRefresh()}}},te=ee,ie=(i("146b"),Object(f["a"])(te,s,n,!1,null,"19edcbfe",null));t["default"]=ie.exports},"2b0b":function(e,t,i){"use strict";var s=i("752b"),n=i.n(s);n.a},"454f":function(e,t,i){i("46a7");var s=i("584a").Object;e.exports=function(e,t,i){return s.defineProperty(e,t,i)}},"456d":function(e,t,i){var s=i("4bf8"),n=i("0d58");i("5eda")("keys",(function(){return function(e){return n(s(e))}}))},"46a7":function(e,t,i){var s=i("63b6");s(s.S+s.F*!i("8e60"),"Object",{defineProperty:i("d9f6").f})},4917:function(e,t,i){"use strict";var s=i("cb7c"),n=i("9def"),a=i("0390"),o=i("5f1b");i("214f")("match",1,(function(e,t,i,r){return[function(i){var s=e(this),n=void 0==i?void 0:i[t];return void 0!==n?n.call(i,s):new RegExp(i)[t](String(s))},function(e){var t=r(i,e,this);if(t.done)return t.value;var c=s(e),l=String(this);if(!c.global)return o(c,l);var u=c.unicode;c.lastIndex=0;var m,d=[],f=0;while(null!==(m=o(c,l))){var h=String(m[0]);d[f]=h,""===h&&(c.lastIndex=a(l,n(c.lastIndex),u)),f++}return 0===f?null:d}]}))},"4e10":function(e,t,i){},"4f37":function(e,t,i){"use strict";i("aa77")("trim",(function(e){return function(){return e(this,3)}}))},"58b2":function(e,t,i){var s=i("5ca1");s(s.S+s.F*!i("9e1e"),"Object",{defineProperties:i("1495")})},"5dbc":function(e,t,i){var s=i("d3f4"),n=i("8b97").set;e.exports=function(e,t,i){var a,o=t.constructor;return o!==i&&"function"==typeof o&&(a=o.prototype)!==i.prototype&&s(a)&&n&&n(e,a),e}},"5eda":function(e,t,i){var s=i("5ca1"),n=i("8378"),a=i("79e5");e.exports=function(e,t){var i=(n.Object||{})[e]||Object[e],o={};o[e]=t(i),s(s.S+s.F*a((function(){i(1)})),"Object",o)}},"752b":function(e,t,i){},"85f2":function(e,t,i){e.exports=i("454f")},"8b97":function(e,t,i){var s=i("d3f4"),n=i("cb7c"),a=function(e,t){if(n(e),!s(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,s){try{s=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),s(e,[]),t=!(e instanceof Array)}catch(n){t=!0}return function(e,i){return a(e,i),t?e.__proto__=i:s(e,i),e}}({},!1):void 0),check:a}},"8e6e":function(e,t,i){var s=i("5ca1"),n=i("990b"),a=i("6821"),o=i("11e9"),r=i("f1ae");s(s.S,"Object",{getOwnPropertyDescriptors:function(e){var t,i,s=a(e),c=o.f,l=n(s),u={},m=0;while(l.length>m)i=c(s,t=l[m++]),void 0!==i&&r(u,t,i);return u}})},9093:function(e,t,i){var s=i("ce10"),n=i("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return s(e,n)}},"990b":function(e,t,i){var s=i("9093"),n=i("2621"),a=i("cb7c"),o=i("7726").Reflect;e.exports=o&&o.ownKeys||function(e){var t=s.f(a(e)),i=n.f;return i?t.concat(i(e)):t}},a481:function(e,t,i){"use strict";var s=i("cb7c"),n=i("4bf8"),a=i("9def"),o=i("4588"),r=i("0390"),c=i("5f1b"),l=Math.max,u=Math.min,m=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,h=function(e){return void 0===e?e:String(e)};i("214f")("replace",2,(function(e,t,i,g){return[function(s,n){var a=e(this),o=void 0==s?void 0:s[t];return void 0!==o?o.call(s,a,n):i.call(String(a),s,n)},function(e,t){var n=g(i,e,this,t);if(n.done)return n.value;var m=s(e),d=String(this),f="function"===typeof t;f||(t=String(t));var p=m.global;if(p){var _=m.unicode;m.lastIndex=0}var b=[];while(1){var C=c(m,d);if(null===C)break;if(b.push(C),!p)break;var y=String(C[0]);""===y&&(m.lastIndex=r(d,a(m.lastIndex),_))}for(var w="",S=0,k=0;k<b.length;k++){C=b[k];for(var x=String(C[0]),$=l(u(o(C.index),d.length),0),I=[],M=1;M<C.length;M++)I.push(h(C[M]));var U=C.groups;if(f){var T=[x].concat(I,$,d);void 0!==U&&T.push(U);var E=String(t.apply(void 0,T))}else E=v(x,d,$,I,U,t);$>=S&&(w+=d.slice(S,$)+E,S=$+x.length)}return w+d.slice(S)}];function v(e,t,s,a,o,r){var c=s+e.length,l=a.length,u=f;return void 0!==o&&(o=n(o),u=d),i.call(r,u,(function(i,n){var r;switch(n.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,s);case"'":return t.slice(c);case"<":r=o[n.slice(1,-1)];break;default:var u=+n;if(0===u)return i;if(u>l){var d=m(u/10);return 0===d?i:d<=l?void 0===a[d-1]?n.charAt(1):a[d-1]+n.charAt(1):i}r=a[u-1]}return void 0===r?"":r}))}}))},a818:function(e,t,i){},aa77:function(e,t,i){var s=i("5ca1"),n=i("be13"),a=i("79e5"),o=i("fdef"),r="["+o+"]",c="â€‹Â…",l=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),m=function(e,t,i){var n={},r=a((function(){return!!o[e]()||c[e]()!=c})),l=n[e]=r?t(d):o[e];i&&(n[i]=l),s(s.P+s.F*r,"String",n)},d=m.trim=function(e,t){return e=String(n(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=m},ac6a:function(e,t,i){for(var s=i("cadf"),n=i("0d58"),a=i("2aba"),o=i("7726"),r=i("32e9"),c=i("84f2"),l=i("2b4c"),u=l("iterator"),m=l("toStringTag"),d=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=n(f),g=0;g<h.length;g++){var v,p=h[g],_=f[p],b=o[p],C=b&&b.prototype;if(C&&(C[u]||r(C,u,d),C[m]||r(C,m,p),c[p]=d,_))for(v in s)C[v]||a(C,v,s[v],!0)}},c5f6:function(e,t,i){"use strict";var s=i("7726"),n=i("69a8"),a=i("2d95"),o=i("5dbc"),r=i("6a99"),c=i("79e5"),l=i("9093").f,u=i("11e9").f,m=i("86cc").f,d=i("aa77").trim,f="Number",h=s[f],g=h,v=h.prototype,p=a(i("2aeb")(v))==f,_="trim"in String.prototype,b=function(e){var t=r(e,!1);if("string"==typeof t&&t.length>2){t=_?t.trim():d(t,3);var i,s,n,a=t.charCodeAt(0);if(43===a||45===a){if(i=t.charCodeAt(2),88===i||120===i)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:s=2,n=49;break;case 79:case 111:s=8,n=55;break;default:return+t}for(var o,c=t.slice(2),l=0,u=c.length;l<u;l++)if(o=c.charCodeAt(l),o<48||o>n)return NaN;return parseInt(c,s)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof h&&(p?c((function(){v.valueOf.call(i)})):a(i)!=f)?o(new g(b(t)),i,h):b(t)};for(var C,y=i("9e1e")?l(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;y.length>w;w++)n(g,C=y[w])&&!n(h,C)&&m(h,C,u(g,C));h.prototype=v,v.constructor=h,i("2aba")(s,f,h)}},d25f:function(e,t,i){"use strict";var s=i("5ca1"),n=i("0a49")(2);s(s.P+s.F*!i("2f21")([].filter,!0),"Array",{filter:function(e){return n(this,e,arguments[1])}})},eef3:function(e,t){var i=["ğŸ˜€","ğŸ˜","ğŸ˜‚","ğŸ¤£","ğŸ˜ƒ","ğŸ˜„","ğŸ˜…","ğŸ˜†","ğŸ˜‰","ğŸ˜Š","ğŸ˜‹","ğŸ˜","ğŸ˜","ğŸ˜˜","ğŸ˜—","ğŸ˜™","ğŸ˜š","ğŸ™‚","ğŸ¤—","ğŸ¤©","ğŸ¤”","ğŸ¤¨","ğŸ˜","ğŸ˜‘","ğŸ˜¶","ğŸ™„","ğŸ˜","ğŸ˜£","ğŸ˜¥","ğŸ˜®","ğŸ¤","ğŸ˜¯","ğŸ˜ª","ğŸ˜«","ğŸ˜´","ğŸ˜Œ","ğŸ˜›","ğŸ˜œ","ğŸ˜","ğŸ¤¤","ğŸ˜’","ğŸ˜“","ğŸ˜”","ğŸ˜•","ğŸ™ƒ","ğŸ¤‘","ğŸ˜²","ğŸ™","ğŸ˜–","ğŸ˜","ğŸ˜Ÿ","ğŸ˜¤","ğŸ˜¢","ğŸ˜­","ğŸ˜¦","ğŸ˜§","ğŸ˜¨","ğŸ˜©","ğŸ¤¯","ğŸ˜¬","ğŸ˜°","ğŸ˜±","ğŸ˜³","ğŸ¤ª","ğŸ˜µ","ğŸ˜¡","ğŸ˜ ","ğŸ¤¬","ğŸ˜·","ğŸ¤’","ğŸ¤•","ğŸ¤¢","ğŸ¤®","ğŸ¤§","ğŸ˜‡","ğŸ¤ ","ğŸ¤¡","ğŸ¤¥","ğŸ¤«","ğŸ¤­","ğŸ§","ğŸ¤“","ğŸ˜ˆ","ğŸ‘¿","ğŸ‘¹","ğŸ‘º","ğŸ’€","ğŸ‘»","ğŸ‘½","ğŸ¤–","ğŸ’©","ğŸ˜º","ğŸ˜¸","ğŸ˜¹","ğŸ˜»","ğŸ˜¼","ğŸ˜½","ğŸ™€","ğŸ˜¿","ğŸ˜¾","ğŸ¤²","ğŸ‘","ğŸ™Œ","ğŸ‘","ğŸ¤","ğŸ‘","ğŸ‘","ğŸ‘Š","âœŠ","ğŸ¤›","ğŸ¤œ","ğŸ¤","âœŒï¸","ğŸ¤Ÿ","ğŸ¤˜","ğŸ‘Œ","ğŸ‘ˆ","ğŸ‘‰","ğŸ‘†","ğŸ‘‡","â˜ï¸","âœ‹","ğŸ¤š","ğŸ–","ğŸ––","ğŸ‘‹","ğŸ¤™","ğŸ’ª","ğŸ–•","âœï¸","ğŸ™"];t.emojiData=i},f1ae:function(e,t,i){"use strict";var s=i("86cc"),n=i("4630");e.exports=function(e,t,i){t in e?s.f(e,t,n(0,i)):e[t]=i}},f3e2:function(e,t,i){"use strict";var s=i("5ca1"),n=i("0a49")(0),a=i("2f21")([].forEach,!0);s(s.P+s.F*!a,"Array",{forEach:function(e){return n(this,e,arguments[1])}})},fa4e:function(e,t,i){},fdef:function(e,t){e.exports="\t\n\v\f\r Â áš€á â€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-2e29b63f.7ff0f22a.js.map